–û—Ç–ª–∏—á–Ω–æ! –ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ —É—Ä–æ–∫—É 2.

---

# üîπ –£—Ä–æ–∫ 2. –†–µ–≥–∏—Å—Ç—Ä—ã –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞ –∏ —Ä–∞–±–æ—Ç–∞ —Å –ø–∞–º—è—Ç—å—é –≤ x86-64 (‚âà 2500 —Å–ª–æ–≤)

---

### –¢–µ–º–∞ —É—Ä–æ–∫–∞:

–î–µ—Ç–∞–ª—å–Ω—ã–π —Ä–∞–∑–±–æ—Ä —Ä–µ–≥–∏—Å—Ç—Ä–æ–≤ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞ x86-64, –∏—Ö –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ –∏ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏. –ú–µ—Ö–∞–Ω–∏–∑–º—ã –∞–¥—Ä–µ—Å–∞—Ü–∏–∏ –ø–∞–º—è—Ç–∏: –ª–∏–Ω–µ–π–Ω–∞—è, —Ñ–∏–∑–∏—á–µ—Å–∫–∞—è, –≤–∏—Ä—Ç—É–∞–ª—å–Ω–∞—è. –ü—Ä–∏–Ω—Ü–∏–ø—ã —Ä–∞–±–æ—Ç—ã —Å –ø–∞–º—è—Ç—å—é, —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è –∏ —Å—Ç—Ä–∞–Ω–∏—á–Ω–∞—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è. –û—Å–Ω–æ–≤—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–∞–º—è—Ç—å—é –≤ –û–°.

---

### 1. –ö—Ä–∞—Ç–∫–æ–µ —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ

---

#### –†–µ–≥–∏—Å—Ç—Ä—ã –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞: —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π —Ä–∞–∑–±–æ—Ä

–í –ø—Ä–µ–¥—ã–¥—É—â–µ–º —É—Ä–æ–∫–µ –º—ã –ø–æ–∑–Ω–∞–∫–æ–º–∏–ª–∏—Å—å —Å –Ω–∞–±–æ—Ä–æ–º 16 64-–±–∏—Ç–Ω—ã—Ö —Ä–µ–≥–∏—Å—Ç—Ä–æ–≤ –æ–±—â–µ–≥–æ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è. –¢–µ–ø–µ—Ä—å –±–æ–ª–µ–µ –ø–æ–¥—Ä–æ–±–Ω–æ —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º –∫–∞–∂–¥—ã–π —Ç–∏–ø —Ä–µ–≥–∏—Å—Ç—Ä–æ–≤ –∏ –∏—Ö –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ.

* **RAX, RBX, RCX, RDX** ‚Äì —Ç—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω—ã–µ —Ä–µ–≥–∏—Å—Ç—Ä—ã –æ–±—â–µ–≥–æ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è —Å –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–º –∑–Ω–∞—á–µ–Ω–∏–µ–º:

  * RAX —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–∞–∫ –∞–∫–∫—É–º—É–ª—è—Ç–æ—Ä –¥–ª—è –∞—Ä–∏—Ñ–º–µ—Ç–∏—á–µ—Å–∫–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π –∏ –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏—è –∑–Ω–∞—á–µ–Ω–∏–π –∏–∑ —Ñ—É–Ω–∫—Ü–∏–π.
  * RCX –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è—Ö —Å–ª—É–∂–∏—Ç —Å—á—ë—Ç—á–∏–∫–æ–º —Ü–∏–∫–ª–æ–≤.
* **RSI –∏ RDI** ‚Äì –æ–±—ã—á–Ω–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Ñ—É–Ω–∫—Ü–∏–π –∏ —É–∫–∞–∑–∞—Ç–µ–ª–µ–π –Ω–∞ —Å—Ç—Ä–æ–∫–∏/–±—É—Ñ–µ—Ä—ã.
* **RBP –∏ RSP** ‚Äì RBP —Å–ª—É–∂–∏—Ç —É–∫–∞–∑–∞—Ç–µ–ª–µ–º –±–∞–∑–æ–≤–æ–≥–æ –∞–¥—Ä–µ—Å–∞ —Ç–µ–∫—É—â–µ–≥–æ —Å—Ç–µ–∫–∞ (frame pointer), RSP ‚Äî —É–∫–∞–∑–∞—Ç–µ–ª–µ–º –≤–µ—Ä—à–∏–Ω—ã —Å—Ç–µ–∫–∞ (stack pointer). –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—Ç–µ–∫–æ–º ‚Äî –∫–ª—é—á–µ–≤–æ–π —ç–ª–µ–º–µ–Ω—Ç –≤—ã–∑–æ–≤–∞ —Ñ—É–Ω–∫—Ü–∏–π –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏–π.
* **R8‚ÄìR15** ‚Äì –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ–≥–∏—Å—Ç—Ä—ã –æ–±—â–µ–≥–æ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è, –ø–æ—è–≤–∏–≤—à–∏–µ—Å—è –≤ x86-64, —Ä–∞—Å—à–∏—Ä—è—é—â–∏–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏.

–í–∞–∂–Ω–æ –ø–æ–Ω–∏–º–∞—Ç—å, —á—Ç–æ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä–æ–≤ –∞–∫—Ç–∏–≤–Ω–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç —ç—Ç–∏ —Ä–µ–≥–∏—Å—Ç—Ä—ã –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ —Ä–∞–±–æ—Ç—ã —Å –¥–∞–Ω–Ω—ã–º–∏, –º–∏–Ω–∏–º–∏–∑–∏—Ä—É—è –æ–±—Ä–∞—â–µ–Ω–∏–µ –∫ –º–µ–¥–ª–µ–Ω–Ω–æ–π –ø–∞–º—è—Ç–∏.

---

#### –†–µ–≥–∏—Å—Ç—Ä—ã —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ –∏ —Å–∏—Å—Ç–µ–º–Ω—ã–µ —Ä–µ–≥–∏—Å—Ç—Ä—ã

* **–°–µ–≥–º–µ–Ω—Ç–Ω—ã–µ —Ä–µ–≥–∏—Å—Ç—Ä—ã:** CS, DS, SS, ES, FS, GS ‚Äî –≤ 64-–±–∏—Ç–Ω–æ–º —Ä–µ–∂–∏–º–µ —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ—á—Ç–∏ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è, –Ω–æ FS –∏ GS –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞–º, —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–º –¥–ª—è —è–¥—Ä–∞ –û–° –∏–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, Thread-Local Storage).
* **–°–∏—Å—Ç–µ–º–Ω—ã–µ —Ä–µ–≥–∏—Å—Ç—Ä—ã:** CR0‚ÄìCR4, CR8 ‚Äî —Ä–µ–≥–∏—Å—Ç—Ä—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–æ–º.

  * CR0 –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç –±–∞–∑–æ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞: –≤–∫–ª—é—á–µ–Ω–∏–µ –∑–∞—â–∏—â—ë–Ω–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞, —Ä–µ–∂–∏–º –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è, –∫–æ–Ω—Ç—Ä–æ–ª—å –≤—ã—á–∏—Å–ª–µ–Ω–∏–π —Å –ø–ª–∞–≤–∞—é—â–µ–π —Ç–æ—á–∫–æ–π –∏ –¥—Ä.
  * CR3 —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ —Ç–∞–±–ª–∏—Ü—É —Å—Ç—Ä–∞–Ω–∏—Ü, –∑–∞–¥–∞—ë—Ç —Ç–µ–∫—É—â–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç –ø–∞–º—è—Ç–∏.
  * CR4 –≤–∫–ª—é—á–∞–µ—Ç —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏: –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏—è, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ SSE, SMEP –∏ –¥—Ä—É–≥–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏.

---

#### –ê–¥—Ä–µ—Å–∞—Ü–∏—è –ø–∞–º—è—Ç–∏: —É—Ä–æ–≤–Ω–∏ –∏ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è

* **–§–∏–∑–∏—á–µ—Å–∫–∏–π –∞–¥—Ä–µ—Å** ‚Äî —Ä–µ–∞–ª—å–Ω—ã–π –∞–¥—Ä–µ—Å –≤ –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –ø–∞–º—è—Ç–∏.
* **–õ–∏–Ω–µ–π–Ω—ã–π –∞–¥—Ä–µ—Å** ‚Äî —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –∞–¥—Ä–µ—Å–∞ —á–µ—Ä–µ–∑ —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—é (–≤ 64-–±–∏—Ç–Ω–æ–º —Ä–µ–∂–∏–º–µ —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ—á—Ç–∏ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è).
* **–í–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π –∞–¥—Ä–µ—Å** ‚Äî –∞–¥—Ä–µ—Å, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π –ø—Ä–æ–≥—Ä–∞–º–º–æ–π, –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç—Å—è –≤ –ª–∏–Ω–µ–π–Ω—ã–π –∏ –¥–∞–ª–µ–µ –≤ —Ñ–∏–∑–∏—á–µ—Å–∫–∏–π —á–µ—Ä–µ–∑ —Å–∏—Å—Ç–µ–º—É —Å—Ç—Ä–∞–Ω–∏—á–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü.

---

#### –°–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è –≤ x86-64

–í 64-–±–∏—Ç–Ω–æ–º —Ä–µ–∂–∏–º–µ —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç—Å—è, –∫—Ä–æ–º–µ FS –∏ GS, –∫–æ—Ç–æ—Ä—ã–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö, —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Å –ø–æ—Ç–æ–∫–æ–º –∏–ª–∏ –ø—Ä–æ—Ü–µ—Å—Å–æ–º (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∞–¥—Ä–µ—Å–∞ TLS ‚Äî thread-local storage). –≠—Ç–æ —É–ø—Ä–æ—â–∞–µ—Ç —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç—å—é –∏ –¥–µ–ª–∞–µ—Ç –≤–∏—Ä—Ç—É–∞–ª—å–Ω—É—é –∞–¥—Ä–µ—Å–∞—Ü–∏—é –±–æ–ª–µ–µ –≥–∏–±–∫–æ–π.

---

#### –°—Ç—Ä–∞–Ω–∏—á–Ω–∞—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è –ø–∞–º—è—Ç–∏

x86-64 –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –º–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤—É—é —Å—Ç—Ä–∞–Ω–∏—á–Ω—É—é —Ç–∞–±–ª–∏—Ü—É –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–∞–º—è—Ç—å—é:

* 4 —É—Ä–æ–≤–Ω—è —Ç–∞–±–ª–∏—Ü —Å—Ç—Ä–∞–Ω–∏—Ü: PML4, PDPT, PD, PT ‚Äî –∫–∞–∂–¥—ã–π —É—Ä–æ–≤–µ–Ω—å –∏–Ω–¥–µ–∫—Å–∏—Ä—É–µ—Ç—Å—è —á–∞—Å—Ç—è–º–∏ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –∞–¥—Ä–µ—Å–∞.
* –†–∞–∑–º–µ—Ä —Å—Ç—Ä–∞–Ω–∏—Ü—ã –æ–±—ã—á–Ω–æ 4 –ö–ë, –Ω–æ –¥–æ—Å—Ç—É–ø–Ω—ã –±–æ–ª—å—à–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã (2 –ú–ë, 1 –ì–ë).
* –°—Ç—Ä–∞–Ω–∏—á–Ω–∞—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è –ø–æ–∑–≤–æ–ª—è–µ—Ç –û–° —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ —É–ø—Ä–∞–≤–ª—è—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –ø–∞–º—è—Ç—å—é, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—Ç—å –∏–∑–æ–ª—è—Ü–∏—é –ø—Ä–æ—Ü–µ—Å—Å–æ–≤, —Ä–µ–∞–ª–∏–∑–æ–≤—ã–≤–∞—Ç—å –ø–æ–¥–∫–∞—á–∫—É –∏ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ.

---

#### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç—å—é –≤ –û–°: –∫–ª—é—á–µ–≤—ã–µ –∑–∞–¥–∞—á–∏

* –°–æ–∑–¥–∞–Ω–∏–µ –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ —Ç–∞–±–ª–∏—Ü —Å—Ç—Ä–∞–Ω–∏—Ü –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞.
* –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ CR3 –¥–ª—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –∞–¥—Ä–µ—Å–Ω–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞.
* –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è –∑–∞—â–∏—Ç—ã –ø–∞–º—è—Ç–∏ (—á—Ç–µ–Ω–∏–µ, –∑–∞–ø–∏—Å—å, –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ).
* –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —Å—Ç—Ä–∞–Ω–∏—Ü—ã (page faults) –∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–¥–∫–∞—á–∫–∏.
* –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ FS/GS –¥–ª—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –ª–æ–∫–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –ø–æ—Ç–æ–∫–æ–≤.

---

### 2. –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã

* [Intel¬Æ 64 and IA-32 Architectures Software Developer‚Äôs Manual, Volume 3 (System Programming Guide)](https://www.intel.com/content/www/us/en/develop/documentation/64-ia-32-architectures-software-developer-manual-325462.html) ‚Äî —Ä–∞–∑–¥–µ–ª –æ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ö –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ –ø–∞–º—è—Ç—å—é.
* *Computer Systems: A Programmer‚Äôs Perspective*, Randal E. Bryant, David R. O‚ÄôHallaron ‚Äî –≥–ª—É–±–æ–∫–∏–π –≤–∑–≥–ª—è–¥ –Ω–∞ –ø–∞–º—è—Ç—å –∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É.
* –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è AMD –ø–æ —Å–∏—Å—Ç–µ–º–µ –∞–¥—Ä–µ—Å–∞—Ü–∏–∏ –∏ —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º.
* [OSDev Wiki ‚Äî x86-64 Paging](https://wiki.osdev.org/X86-64_Paging) ‚Äî –æ—Ç–ª–∏—á–Ω—ã–π –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ—Å—É—Ä—Å –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è —Å—Ç—Ä–∞–Ω–∏—á–Ω–æ–π –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏.
* –°—Ç–∞—Ç—å–∏ –∏ –≤–∏–¥–µ–æ—É—Ä–æ–∫–∏ –ø–æ –ª–æ–∫–∞–ª—å–Ω–æ–º—É —Ö—Ä–∞–Ω–∏–ª–∏—â—É –ø–æ—Ç–æ–∫–æ–≤ (TLS) –≤ Linux/Windows.

---

### 3. –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–º–µ—Ä—ã –Ω–∞ C23

```c
/*
 * –ü—Ä–∏–º–µ—Ä 2: –†–∞–±–æ—Ç–∞ —Å —É–∫–∞–∑–∞—Ç–µ–ª—è–º–∏ –∏ –∏–º–∏—Ç–∞—Ü–∏—è –∞–¥—Ä–µ—Å–∞—Ü–∏–∏ –ø–∞–º—è—Ç–∏
 * –ó–∞–¥–∞—á–∞: –ø–æ–Ω—è—Ç—å –∫–∞–∫ —É—Å—Ç—Ä–æ–µ–Ω–∞ –ª–∏–Ω–µ–π–Ω–∞—è –∏ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–∞—è –∞–¥—Ä–µ—Å–∞—Ü–∏—è –Ω–∞ –ø—Ä–∏–º–µ—Ä–µ –ø—Ä–æ—Å—Ç—ã—Ö —Å—Ç—Ä—É–∫—Ç—É—Ä.
 */

#include <stdio.h>
#include <stdint.h>

#define PAGE_SIZE 4096

typedef uint64_t phys_addr_t;  // –§–∏–∑–∏—á–µ—Å–∫–∏–π –∞–¥—Ä–µ—Å
typedef uint64_t virt_addr_t;  // –í–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π –∞–¥—Ä–µ—Å

// –ü—Ä–æ—Å—Ç–∞—è –∏–º–∏—Ç–∞—Ü–∏—è —Ç–∞–±–ª–∏—Ü—ã —Å—Ç—Ä–∞–Ω–∏—Ü —Å 4 —É—Ä–æ–≤–Ω—è–º–∏
typedef struct PageTableEntry {
    uint64_t present : 1;
    uint64_t rw : 1;
    uint64_t user : 1;
    uint64_t pwt : 1;
    uint64_t pcd : 1;
    uint64_t accessed : 1;
    uint64_t dirty : 1;
    uint64_t pat : 1;
    uint64_t global : 1;
    uint64_t ignored : 3;
    uint64_t frame_addr : 40; // –ê–¥—Ä–µ—Å —Ñ–∏–∑–∏—á–µ—Å–∫–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã
    uint64_t reserved : 11;
    uint64_t execute_disable : 1;
} __attribute__((packed)) PageTableEntry;

void print_address_translation(virt_addr_t virt_addr, phys_addr_t phys_addr) {
    printf("–í–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π –∞–¥—Ä–µ—Å: 0x%016llx\n", virt_addr);
    printf("–§–∏–∑–∏—á–µ—Å–∫–∏–π –∞–¥—Ä–µ—Å: 0x%016llx\n", phys_addr);
}

int main(void) {
    virt_addr_t virtual_address = 0x7FFF'1234'5678'9ABC;
    phys_addr_t physical_address = 0x0000'0ABC'DEF0'1234;

    print_address_translation(virtual_address, physical_address);

    // –ó–¥–µ—Å—å –º–æ–≥–ª–∞ –±—ã –±—ã—Ç—å –ª–æ–≥–∏–∫–∞ —Ç—Ä–∞–Ω—Å–ª—è—Ü–∏–∏ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –∞–¥—Ä–µ—Å–∞ –≤ —Ñ–∏–∑–∏—á–µ—Å–∫–∏–π,
    // –∏—Å–ø–æ–ª—å–∑—É—è —Ç–∞–±–ª–∏—Ü—ã —Å—Ç—Ä–∞–Ω–∏—Ü (–Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ —Ç—Ä–µ–±—É–µ—Ç —Ä–∞–±–æ—Ç—ã —Å –∞–ø–ø–∞—Ä–∞—Ç–Ω—ã–º–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞–º–∏).

    return 0;
}
```

*–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏:*

* –í —Ä–µ–∞–ª—å–Ω–æ–π –û–° —Ç–∞–±–ª–∏—Ü—ã —Å—Ç—Ä–∞–Ω–∏—Ü —Å—Ç—Ä–æ—è—Ç—Å—è –≤ –æ—Å–æ–±–æ–º —Ñ–æ—Ä–º–∞—Ç–µ –∏ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –ø–∞–º—è—Ç–∏.
* –ü—Ä–∏–º–µ—Ä –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –±–∞–∑–æ–≤–æ–µ –ø–æ–Ω–∏–º–∞–Ω–∏–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö –∏ —Ñ–∏–∑–∏—á–µ—Å–∫–∏—Ö –∞–¥—Ä–µ—Å–æ–≤.

---

### 4. –£—Ä–æ–≤–µ–Ω—å —Å–ª–æ–∂–Ω–æ—Å—Ç–∏: 5/10

(–°—Ä–µ–¥–Ω–∏–π —É—Ä–æ–≤–µ–Ω—å, —Ç—Ä–µ–±—É–µ—Ç—Å—è –∑–Ω–∞–Ω–∏–µ C, –ø–æ–Ω–∏–º–∞–Ω–∏–µ –æ—Å–Ω–æ–≤ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –∏ —Ä–∞–±–æ—Ç—ã —Å –ø–∞–º—è—Ç—å—é.)

---

### 5. –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–æ–µ –≤—Ä–µ–º—è –Ω–∞ –∏–∑—É—á–µ–Ω–∏–µ: 7‚Äì9 —á–∞—Å–æ–≤

---

### 6. –ú–µ—Ç–æ–¥–∏–∫–∞ –ø—Ä–µ–ø–æ–¥–∞–≤–∞–Ω–∏—è

* **–õ–µ–∫—Ü–∏—è:** –¥–µ—Ç–∞–ª—å–Ω—ã–π —Ä–∞–∑–±–æ—Ä —Ä–µ–≥–∏—Å—Ç—Ä–æ–≤ –∏ –º–µ—Ö–∞–Ω–∏–∑–º–æ–≤ –∞–¥—Ä–µ—Å–∞—Ü–∏–∏ –ø–∞–º—è—Ç–∏.
* **–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è:** –ø–æ—à–∞–≥–æ–≤–æ–µ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü —Å—Ç—Ä–∞–Ω–∏—Ü, –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —É—Ä–æ–≤–Ω–µ–π.
* **–°—Ö–µ–º–∞:** –¥–∏–∞–≥—Ä–∞–º–º—ã —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏–∏, —É—Ä–æ–≤–Ω–µ–π —Å—Ç—Ä–∞–Ω–∏—á–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü.
* **–°–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞:** —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–ª—è —Ç–∞–±–ª–∏—Ü—ã —Å—Ç—Ä–∞–Ω–∏—Ü, –∏–∑—É—á–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —Ä–µ–≥–∏—Å—Ç—Ä–æ–≤.
* **–î–æ–º–∞—à–Ω–µ–µ –∑–∞–¥–∞–Ω–∏–µ:** –Ω–∞–ø–∏—Å–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–∞—Å—á—ë—Ç–∞ –∏–Ω–¥–µ–∫—Å–æ–≤ –≤ —Å—Ç—Ä–∞–Ω–∏—á–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü–∞—Ö –∏ —Å–∏–º—É–ª—è—Ü–∏—é —Ç—Ä–∞–Ω—Å–ª—è—Ü–∏–∏ –∞–¥—Ä–µ—Å–∞.

---

–ï—Å–ª–∏ –≥–æ—Ç–æ–≤, –≥–æ–≤–æ—Ä–∏ ¬´–¥–∞¬ª ‚Äî –ø–µ—Ä–µ–π–¥—ë–º –∫ —É—Ä–æ–∫—É 3!

