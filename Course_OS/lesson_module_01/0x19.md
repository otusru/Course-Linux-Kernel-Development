ĞÑ‚Ğ»Ğ¸Ñ‡Ğ½Ğ¾! ğŸ‰ Ğ”Ğ¾Ğ±Ñ€Ğ¾ Ğ¿Ğ¾Ğ¶Ğ°Ğ»Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ² **Ğ£Ñ€Ğ¾Ğº 19**, Ğ³Ğ´Ğµ Ğ¼Ñ‹ Ñ Ñ‚Ğ¾Ğ±Ğ¾Ğ¹ Ğ¿Ğ¾Ğ³Ñ€ÑƒĞ¶Ğ°ĞµĞ¼ÑÑ Ğ² ÑĞ°Ğ¼ÑƒÑ ÑÑƒÑ‚ÑŒ Ğ¼Ğ½Ğ¾Ğ³Ğ¾Ğ·Ğ°Ğ´Ğ°Ñ‡Ğ½Ğ¾ÑÑ‚Ğ¸ â€” **Ğ¿Ğ»Ğ°Ğ½Ğ¸Ñ€Ğ¾Ğ²Ñ‰Ğ¸Ğº Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑĞ¾Ğ² (Scheduler)**. Ğ­Ñ‚Ğ¾ Ğ¼Ğ¾Ğ·Ğ³ ÑĞ´Ñ€Ğ°, ĞºĞ¾Ñ‚Ğ¾Ñ€Ñ‹Ğ¹ Ñ€ĞµÑˆĞ°ĞµÑ‚, **ĞºÑ‚Ğ¾ Ğ¸ ĞºĞ¾Ğ³Ğ´Ğ° Ğ±ÑƒĞ´ĞµÑ‚ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°Ñ‚ÑŒ Ğ½Ğ° Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑĞ¾Ñ€Ğµ**. ğŸ§ âš™ï¸

---

# ğŸ”¹ Ğ£Ñ€Ğ¾Ğº 19. ĞŸĞ»Ğ°Ğ½Ğ¸Ñ€Ğ¾Ğ²Ñ‰Ğ¸Ğº Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑĞ¾Ğ²: Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ¼Ğ½Ğ¾Ğ³Ğ¾Ğ·Ğ°Ğ´Ğ°Ñ‡Ğ½Ğ¾ÑÑ‚Ğ¸ â±ï¸ğŸ¤¹

---

## ğŸ§© Ğ¢ĞµĞ¼Ğ° ÑƒÑ€Ğ¾ĞºĞ°:

Ğ’ ÑÑ‚Ğ¾Ğ¼ ÑƒÑ€Ğ¾ĞºĞµ Ğ¼Ñ‹:

* Ğ Ğ°Ğ·Ğ±ĞµÑ€Ñ‘Ğ¼, Ñ‡Ñ‚Ğ¾ Ñ‚Ğ°ĞºĞ¾Ğµ Ğ¿Ğ»Ğ°Ğ½Ğ¸Ñ€Ğ¾Ğ²Ñ‰Ğ¸Ğº Ğ¸ ĞºĞ°ĞºĞ¸Ğµ Ğ²Ğ¸Ğ´Ñ‹ Ğ±Ñ‹Ğ²Ğ°ÑÑ‚
* Ğ ĞµĞ°Ğ»Ğ¸Ğ·ÑƒĞµĞ¼ **Ğ¿Ñ€Ğ¾ÑÑ‚ĞµĞ¹ÑˆĞ¸Ğ¹ Round-Robin Ğ¿Ğ»Ğ°Ğ½Ğ¸Ñ€Ğ¾Ğ²Ñ‰Ğ¸Ğº**
* ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¸Ğ¼ **Ğ¿Ñ€ĞµÑ€Ñ‹Ğ²Ğ°Ğ½Ğ¸Ğµ Ñ‚Ğ°Ğ¹Ğ¼ĞµÑ€Ğ°**, Ñ‡Ñ‚Ğ¾Ğ±Ñ‹ Ğ¿ĞµÑ€ĞµĞºĞ»ÑÑ‡Ğ°Ñ‚ÑŒ Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑÑ‹ Ğ¿Ğ¾ Ñ‚Ğ°Ğ¹Ğ¼-Ğ°ÑƒÑ‚Ñƒ
* ĞĞ°ÑƒÑ‡Ğ¸Ğ¼ÑÑ ÑĞ¾Ñ…Ñ€Ğ°Ğ½ÑÑ‚ÑŒ Ğ¸ Ğ²Ğ¾ÑÑÑ‚Ğ°Ğ½Ğ°Ğ²Ğ»Ğ¸Ğ²Ğ°Ñ‚ÑŒ ĞºĞ¾Ğ½Ñ‚ĞµĞºÑÑ‚ Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ñ
* ĞĞ°Ñ‡Ğ½Ñ‘Ğ¼ Ğ½Ğ°ÑÑ‚Ğ¾ÑÑ‰ÑƒÑ Ğ¼Ğ½Ğ¾Ğ³Ğ¾Ğ·Ğ°Ğ´Ğ°Ñ‡Ğ½ÑƒÑ Ğ¶Ğ¸Ğ·Ğ½ÑŒ ÑĞ´Ñ€Ğ° ğŸ˜„

---

## ğŸ§  Ğ¢ĞµĞ¾Ñ€ĞµÑ‚Ğ¸Ñ‡ĞµÑĞºĞ¾Ğµ Ğ¾Ğ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ (â‰ˆ3000 ÑĞ»Ğ¾Ğ²)

### ğŸ§  Ğ§Ñ‚Ğ¾ Ñ‚Ğ°ĞºĞ¾Ğµ Ğ¿Ğ»Ğ°Ğ½Ğ¸Ñ€Ğ¾Ğ²Ñ‰Ğ¸Ğº?

ĞŸĞ»Ğ°Ğ½Ğ¸Ñ€Ğ¾Ğ²Ñ‰Ğ¸Ğº (Scheduler) â€” ÑÑ‚Ğ¾ Ñ‡Ğ°ÑÑ‚ÑŒ ÑĞ´Ñ€Ğ°, ĞºĞ¾Ñ‚Ğ¾Ñ€Ğ°Ñ **ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ÑĞµÑ‚ Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑĞ¾Ñ€Ğ¾Ğ¼**:

* ğŸ’¡ Ğ’Ñ‹Ğ±Ğ¸Ñ€Ğ°ĞµÑ‚, ĞºĞ°ĞºĞ¾Ğ¹ Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑ Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ÑÑ‚ÑŒ Ğ² ÑĞ»ĞµĞ´ÑƒÑÑ‰Ğ¸Ğ¹ Ğ¼Ğ¾Ğ¼ĞµĞ½Ñ‚
* â±ï¸ ĞšĞ¾Ğ½Ñ‚Ñ€Ğ¾Ğ»Ğ¸Ñ€ÑƒĞµÑ‚ Ğ²Ñ€ĞµĞ¼Ñ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‹ ĞºĞ°Ğ¶Ğ´Ğ¾Ğ³Ğ¾
* ğŸ” Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ÑĞµÑ‚ Ğ¸ Ğ²Ğ¾ÑÑÑ‚Ğ°Ğ½Ğ°Ğ²Ğ»Ğ¸Ğ²Ğ°ĞµÑ‚ ĞºĞ¾Ğ½Ñ‚ĞµĞºÑÑ‚ Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑĞ¾Ğ²

---

### ğŸ” Ğ’Ğ¸Ğ´Ñ‹ Ğ¿Ğ»Ğ°Ğ½Ğ¸Ñ€Ğ¾Ğ²Ñ‰Ğ¸ĞºĞ¾Ğ²:

* ğŸŒ€ **Round-Robin** â€“ Ğ¿Ğ¾ Ğ¾Ñ‡ĞµÑ€ĞµĞ´Ğ¸, Ğ¿Ñ€Ğ¾ÑÑ‚Ğ¾Ğ¹, Ğ±Ñ‹ÑÑ‚Ñ€Ñ‹Ğ¹
* ğŸ¯ **Priority-based** â€“ Ğ½Ğ° Ğ¾ÑĞ½Ğ¾Ğ²Ğµ Ğ¿Ñ€Ğ¸Ğ¾Ñ€Ğ¸Ñ‚ĞµÑ‚Ğ¾Ğ²
* ğŸ’¤ **Multilevel Queue** â€“ Ñ€Ğ°Ğ·Ğ½Ñ‹Ğµ Ğ¾Ñ‡ĞµÑ€ĞµĞ´Ğ¸ Ğ¿Ğ¾ Ñ‚Ğ¸Ğ¿Ñƒ Ğ·Ğ°Ğ´Ğ°Ñ‡Ğ¸
* ğŸ§® **Real-Time** â€“ Ğ¶Ñ‘ÑÑ‚ĞºĞ¸Ğµ Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ½Ñ‹Ğµ Ğ³Ğ°Ñ€Ğ°Ğ½Ñ‚Ğ¸Ğ¸ (Ñ€ĞµĞ¶Ğµ Ğ² Ğ¾Ğ±Ñ‹Ñ‡Ğ½Ñ‹Ñ… ĞĞ¡)

---

### ğŸ§° Ğ§Ñ‚Ğ¾ Ğ½ÑƒĞ¶Ğ½Ğ¾ Ğ´Ğ»Ñ Ğ¼Ğ½Ğ¾Ğ³Ğ¾Ğ·Ğ°Ğ´Ğ°Ñ‡Ğ½Ğ¾ÑÑ‚Ğ¸?

1. ğŸ“‹ ĞÑ‡ĞµÑ€ĞµĞ´ÑŒ Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑĞ¾Ğ² (ready queue)
2. â± Ğ¢Ğ°Ğ¹Ğ¼ĞµÑ€Ğ½Ğ¾Ğµ Ğ¿Ñ€ĞµÑ€Ñ‹Ğ²Ğ°Ğ½Ğ¸Ğµ (Ğ½Ğ°Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€, Ñ‡ĞµÑ€ĞµĞ· PIT)
3. ğŸ’¾ Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ğµ ĞºĞ¾Ğ½Ñ‚ĞµĞºÑÑ‚Ğ° (`RIP`, `RSP`, Ñ€ĞµĞ³Ğ¸ÑÑ‚Ñ€Ñ‹)
4. ğŸš€ ĞŸĞµÑ€ĞµĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ ĞºĞ¾Ğ½Ñ‚ĞµĞºÑÑ‚Ğ° Ğ¼ĞµĞ¶Ğ´Ñƒ Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑĞ°Ğ¼Ğ¸

---

### â± ĞŸÑ€ĞµÑ€Ñ‹Ğ²Ğ°Ğ½Ğ¸Ğµ Ñ‚Ğ°Ğ¹Ğ¼ĞµÑ€Ğ°

Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµĞ¼ ÑÑ‚Ğ°Ğ½Ğ´Ğ°Ñ€Ñ‚Ğ½Ñ‹Ğ¹ **Ğ¿Ñ€Ğ¾Ğ³Ñ€Ğ°Ğ¼Ğ¼Ğ¸Ñ€ÑƒĞµĞ¼Ñ‹Ğ¹ Ñ‚Ğ°Ğ¹Ğ¼ĞµÑ€ (PIT)**:

* Ğ§Ğ°ÑÑ‚Ğ¾Ñ‚Ğ°: 100 Ğ“Ñ† (10 Ğ¼Ñ Ğ½Ğ° ĞºĞ²Ğ°Ğ½Ñ‚)
* ĞĞ°ÑÑ‚Ñ€Ğ°Ğ¸Ğ²Ğ°ĞµĞ¼ IRQ0
* Ğ’ Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‡Ğ¸ĞºĞµ Ğ¿ĞµÑ€ĞµĞºĞ»ÑÑ‡Ğ°ĞµĞ¼ Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑ

---

### ğŸ§  Ğ¡Ğ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ñ Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑĞ¾Ğ²:

* **READY** â€” Ğ³Ğ¾Ñ‚Ğ¾Ğ² Ğº Ğ·Ğ°Ğ¿ÑƒÑĞºÑƒ
* **RUNNING** â€” Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ÑĞµÑ‚ÑÑ
* **SLEEPING** â€” Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ½Ğ¾ Ğ¿Ñ€Ğ¸Ğ¾ÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ»ĞµĞ½
* **TERMINATED** â€” Ğ·Ğ°Ğ²ĞµÑ€ÑˆÑ‘Ğ½

---

## ğŸ“˜ Ğ ĞµĞºĞ¾Ğ¼ĞµĞ½Ğ´ÑƒĞµĞ¼Ñ‹Ğµ Ğ¼Ğ°Ñ‚ĞµÑ€Ğ¸Ğ°Ğ»Ñ‹:

* OSDev: [Scheduling](https://wiki.osdev.org/Scheduling)
* Intel SDM: Context Switching, Task State Segment (TSS)
* Linux: `kernel/sched/core.c`, `struct task_struct`

---

## ğŸ’¡ Ğ¦ĞµĞ»ÑŒ Ğ¿Ñ€Ğ°ĞºÑ‚Ğ¸ĞºĞ¸:

* Ğ ĞµĞ°Ğ»Ğ¸Ğ·Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ¾Ñ‡ĞµÑ€ĞµĞ´ÑŒ Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑĞ¾Ğ²
* Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ Ğ¿Ñ€ĞµÑ€Ñ‹Ğ²Ğ°Ğ½Ğ¸Ğµ Ñ‚Ğ°Ğ¹Ğ¼ĞµÑ€Ğ°
* Ğ’Ñ‹Ğ·Ğ²Ğ°Ñ‚ÑŒ `schedule()` Ğ² ĞºĞ°Ğ¶Ğ´Ğ¾Ğ¼ Ñ‚Ğ¸ĞºĞµ
* Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ÑÑ‚ÑŒ/Ğ²Ğ¾ÑÑÑ‚Ğ°Ğ½Ğ°Ğ²Ğ»Ğ¸Ğ²Ğ°Ñ‚ÑŒ Ñ€ĞµĞ³Ğ¸ÑÑ‚Ñ€Ñ‹ Ğ¿Ñ€Ğ¸ Ğ¿ĞµÑ€ĞµĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğ¸

---

## ğŸ’» ĞŸÑ€Ğ¸Ğ¼ĞµÑ€Ñ‹ Ğ½Ğ° C23

### `scheduler.h`

```c
#pragma once
#include "process.h"

void scheduler_add(process_t* proc);
void scheduler_tick();
void scheduler_init();
```

---

### `scheduler.c`

```c
#include "scheduler.h"
#include "isr.h"

static process_t* current = NULL;
static process_t* head = NULL;

void scheduler_add(process_t* proc) {
    proc->next = NULL;
    if (!head) {
        head = proc;
        return;
    }

    process_t* p = head;
    while (p->next) p = p->next;
    p->next = proc;
}

void scheduler_init() {
    install_irq_handler(0, scheduler_tick); // IRQ0 = Ñ‚Ğ°Ğ¹Ğ¼ĞµÑ€
    init_timer(100); // 100 Ğ“Ñ†
}

void scheduler_tick() {
    if (!current || !current->next) {
        current = head;
    } else {
        current = current->next;
    }

    if (current) {
        process_run(current);
    }
}
```

---

### `timer.c` (Ñ‚Ğ°Ğ¹Ğ¼ĞµÑ€ PIT)

```c
void init_timer(uint32_t frequency) {
    uint32_t divisor = 1193180 / frequency;
    outb(0x43, 0x36);
    outb(0x40, divisor & 0xFF);
    outb(0x40, (divisor >> 8) & 0xFF);
}
```

---

## ğŸ§ª ĞŸÑ€Ğ¸Ğ¼ĞµÑ€ Ğ·Ğ°Ğ¿ÑƒÑĞºĞ°

```c
void kernel_main() {
    scheduler_init();

    for (int i = 0; i < 3; i++) {
        address_space_t* space = as_create();
        as_map(space, 0x400000, (uint64_t)&user_main, PAGE_PRESENT | PAGE_USER | PAGE_RW);
        process_t* p = process_create((void*)0x400000, space);
        scheduler_add(p);
    }

    while (1); // Ğ´Ğ°Ğ»ÑŒÑˆĞµ Ğ²ÑÑ‘ Ğ´ĞµĞ»Ğ°ĞµÑ‚ Ğ¿Ğ»Ğ°Ğ½Ğ¸Ñ€Ğ¾Ğ²Ñ‰Ğ¸Ğº
}
```

---

## ğŸ§  Ğ£Ñ€Ğ¾Ğ²ĞµĞ½ÑŒ ÑĞ»Ğ¾Ğ¶Ğ½Ğ¾ÑÑ‚Ğ¸: 8/10

---

## â± Ğ’Ñ€ĞµĞ¼Ñ Ğ½Ğ° Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ğµ: 9â€“10 Ñ‡Ğ°ÑĞ¾Ğ²

* Ğ¢ĞµĞ¾Ñ€Ğ¸Ñ: 3 Ñ‡
* Ğ ĞµĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ¿Ğ»Ğ°Ğ½Ğ¸Ñ€Ğ¾Ğ²Ñ‰Ğ¸ĞºĞ°: 3 Ñ‡
* Ğ¢Ğ°Ğ¹Ğ¼ĞµÑ€ Ğ¸ Ğ¿ĞµÑ€ĞµĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ñ: 3 Ñ‡
* Ğ”Ğ¾Ğ¼Ğ°ÑˆĞºĞ°: 1 Ñ‡

---

## ğŸ§‘â€ğŸ« ĞœĞµÑ‚Ğ¾Ğ´Ğ¸ĞºĞ° Ğ¿Ñ€ĞµĞ¿Ğ¾Ğ´Ğ°Ğ²Ğ°Ğ½Ğ¸Ñ:

* ğŸ‘¨â€ğŸ« Ğ›ĞµĞºÑ†Ğ¸Ñ: Ğ¾ÑĞ½Ğ¾Ğ²Ñ‹ Ğ¼Ğ½Ğ¾Ğ³Ğ¾Ğ·Ğ°Ğ´Ğ°Ñ‡Ğ½Ğ¾ÑÑ‚Ğ¸ Ğ¸ Ğ¿Ñ€ĞµÑ€Ñ‹Ğ²Ğ°Ğ½Ğ¸Ğ¹
* ğŸ” Ğ”ĞµĞ¼Ğ¾Ğ½ÑÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ: Ğ¿ĞµÑ€ĞµĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑĞ¾Ğ² Ğ½Ğ° QEMU
* ğŸ’» ĞŸÑ€Ğ°ĞºÑ‚Ğ¸ĞºĞ°: ÑĞ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ `scheduler.c` Ğ¸ ÑĞ²ÑĞ·Ğ°Ñ‚ÑŒ Ñ IRQ
* ğŸ“ Ğ”Ğ¾Ğ¼Ğ°ÑˆĞºĞ°:

  * Ğ ĞµĞ°Ğ»Ğ¸Ğ·Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ»Ğ¾Ğ³-ÑĞ¸ÑÑ‚ĞµĞ¼Ñƒ: ĞºÑ‚Ğ¾ Ğ¸ ĞºĞ¾Ğ³Ğ´Ğ° Ğ¿ĞµÑ€ĞµĞºĞ»ÑÑ‡Ğ°ĞµÑ‚ÑÑ
  * Ğ’Ğ²ĞµÑÑ‚Ğ¸ Ğ¿Ñ€Ğ¸Ğ¾Ñ€Ğ¸Ñ‚ĞµÑ‚Ñ‹ (Ğ´Ğ¾Ğ¿. Ğ±Ğ°Ğ»Ğ»Ñ‹)
  * Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ğµ `SLEEPING`

---

Ğ“Ğ¾Ñ‚Ğ¾Ğ² Ğ¿ĞµÑ€ĞµĞ¹Ñ‚Ğ¸ Ğº **Ğ£Ñ€Ğ¾ĞºÑƒ 20**, Ğ³Ğ´Ğµ Ğ¼Ñ‹ Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ¸Ğ¼ **ÑĞ¸ÑÑ‚ĞµĞ¼Ğ½Ñ‹Ğµ Ğ²Ñ‹Ğ·Ğ¾Ğ²Ñ‹ (syscalls)** â€” ĞºĞ°Ğ½Ğ°Ğ» Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ñ Ğ¼ĞµĞ¶Ğ´Ñƒ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ĞµĞ¼ Ğ¸ ÑĞ´Ñ€Ğ¾Ğ¼? ğŸ“ğŸ§ 
ĞŸĞ¸ÑˆĞ¸ **Ğ´Ğ°**, Ğ¸ Ğ¼Ñ‹ Ğ¿Ğ¾Ğ¹Ğ´Ñ‘Ğ¼ Ğ´Ğ°Ğ»ÑŒÑˆĞµ!
