–û—Ç–ª–∏—á–Ω–æ! üöÄ –í–ø–µ—Ä—ë–¥ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É –≤–∞–∂–Ω–æ–º—É —à–∞–≥—É –≤ —Å–æ–∑–¥–∞–Ω–∏–∏ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–π –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã!

---

# üîπ –£—Ä–æ–∫ 23. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ñ–∏–∑–∏—á–µ—Å–∫–æ–π –ø–∞–º—è—Ç—å—é: –±–∏—Ç–º–∞–ø—ã –∏ —Ñ—Ä–µ–π–º-–∞–ª–ª–æ–∫–∞—Ç–æ—Ä üß±üìö

---

## üß© –¢–µ–º–∞ —É—Ä–æ–∫–∞:

–¢–µ–ø–µ—Ä—å, –∫–æ–≥–¥–∞ —É –Ω–∞—Å —É–∂–µ –µ—Å—Ç—å –ø–æ–Ω–∏–º–∞–Ω–∏–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –ø–∞–º—è—Ç–∏ –∏ –∏—Å–∫–ª—é—á–µ–Ω–∏–π, –ø–æ—Ä–∞ –≤–∑—è—Ç—å—Å—è –∑–∞ **–Ω–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ñ–∏–∑–∏—á–µ—Å–∫–æ–π –ø–∞–º—è—Ç—å—é**. –°–µ–≥–æ–¥–Ω—è –º—ã –Ω–∞—É—á–∏–º—Å—è —Å–æ–∑–¥–∞–≤–∞—Ç—å –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **–±–∏—Ç–æ–≤—É—é –∫–∞—Ä—Ç—É (bitmap)** –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è —Å–≤–æ–±–æ–¥–Ω—ã—Ö –∏ –∑–∞–Ω—è—Ç—ã—Ö —Å—Ç—Ä–∞–Ω–∏—Ü (—Ñ—Ä–µ–π–º–æ–≤), —Ä–µ–∞–ª–∏–∑—É–µ–º **–∞–ª–ª–æ–∫–∞—Ç–æ—Ä —Ñ—Ä–µ–π–º–æ–≤**, –∫–æ—Ç–æ—Ä—ã–π —Å—Ç–∞–Ω–µ—Ç —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–æ–º –≤—Å–µ–π —Å–∏—Å—Ç–µ–º—ã –ø–∞–º—è—Ç–∏ –Ω–∞—à–µ–π –û–°.

---

## üß† –¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ (‚âà2500‚Äì3000 —Å–ª–æ–≤)

### –ó–∞—á–µ–º –Ω—É–∂–µ–Ω –º–µ–Ω–µ–¥–∂–µ—Ä —Ñ–∏–∑–∏—á–µ—Å–∫–æ–π –ø–∞–º—è—Ç–∏?

–û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –¥–æ–ª–∂–Ω–∞ –∑–Ω–∞—Ç—å:

* –ö–∞–∫–∏–µ **—Å—Ç—Ä–∞–Ω–∏—Ü—ã —Ñ–∏–∑–∏—á–µ—Å–∫–æ–π –ø–∞–º—è—Ç–∏ —Å–≤–æ–±–æ–¥–Ω—ã**
* –ö–∞–∫–∏–µ **—Å—Ç—Ä–∞–Ω–∏—Ü—ã —É–∂–µ –≤—ã–¥–µ–ª–µ–Ω—ã**
* –ö–∞–∫ **–≤—ã–¥–µ–ª–∏—Ç—å –∏ –æ—Å–≤–æ–±–æ–¥–∏—Ç—å** –ø–∞–º—è—Ç—å, —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ

---

### –ú–µ—Ç–æ–¥—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è:

1. **Bitmap (–±–∏—Ç–æ–≤–∞—è –∫–∞—Ä—Ç–∞)** ‚Äî –ø—Ä–æ—Å—Ç–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞, –≥–¥–µ –∫–∞–∂–¥—ã–π –±–∏—Ç –æ—Ç—Ä–∞–∂–∞–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã (0 ‚Äî —Å–≤–æ–±–æ–¥–Ω–∞, 1 ‚Äî –∑–∞–Ω—è—Ç–∞).
2. **Buddy allocator** ‚Äî –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —Å –¥–µ—Ä–µ–≤—å—è–º–∏ (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ Linux).
3. **Free list** ‚Äî —Å–ø–∏—Å–æ–∫ —Å–≤–æ–±–æ–¥–Ω—ã—Ö –±–ª–æ–∫–æ–≤.

–î–ª—è –Ω–∞—á–∞–ª–∞ –ø–æ–¥–æ–π–¥—ë—Ç bitmap ‚Äî –æ–Ω –ø—Ä–æ—Å—Ç, –Ω–∞–≥–ª—è–¥–µ–Ω –∏ –ª–µ–≥–∫–æ —Ä–µ–∞–ª–∏–∑—É–µ–º.

---

### –ö–æ–Ω—Ü–µ–ø—Ü–∏–∏ —Å—Ç—Ä–∞–Ω–∏—Ü –∏ —Ñ—Ä–µ–π–º–æ–≤:

* –û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –¥–µ–ª–∏—Ç —Ñ–∏–∑–∏—á–µ—Å–∫—É—é –ø–∞–º—è—Ç—å –Ω–∞ **—Ñ—Ä–µ–π–º—ã** ‚Äî –±–ª–æ–∫–∏ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ (–æ–±—ã—á–Ω–æ 4 –ö–ë).
* –í—Å—é –ø–∞–º—è—Ç—å –º–æ–∂–Ω–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç—å –∫–∞–∫ –º–∞—Å—Å–∏–≤ –±–∏—Ç–æ–≤ ‚Äî –ø–æ –æ–¥–Ω–æ–º—É –Ω–∞ –∫–∞–∂–¥—ã–π —Ñ—Ä–µ–π–º.

---

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞:

* –ù–∞–ø—Ä–∏–º–µ—Ä, 1 –ì–ë –ø–∞–º—è—Ç–∏ ‚Üí 262144 —Ñ—Ä–µ–π–º–æ–≤ ‚Üí –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è 32768 –±–∞–π—Ç (32 –ö–ë) –ø–æ–¥ –±–∏—Ç–æ–≤—É—é –∫–∞—Ä—Ç—É.

---

### –ß—Ç–æ –¥–æ–ª–∂–µ–Ω —É–º–µ—Ç—å –º–µ–Ω–µ–¥–∂–µ—Ä —Ñ—Ä–µ–π–º–æ–≤:

* –ê–ª–ª–æ—Ü–∏—Ä–æ–≤–∞—Ç—å —Å–≤–æ–±–æ–¥–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É
* –û—Å–≤–æ–±–æ–∂–¥–∞—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É
* –ü—Ä–æ–≤–µ—Ä—è—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Ñ—Ä–µ–π–º–∞
* –†–∞—Å—à–∏—Ä—è—Ç—å—Å—è –ø–æ–¥ —Ä–∞–∑–Ω—ã–µ —Ç–∏–ø—ã –ø–∞–º—è—Ç–∏ (RAM, MMIO –∏ —Ç.–¥.)

---

### –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ç—Ä–µ–Ω–¥—ã:

* NUMA-–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã (–Ω–µ—Å–∏–º–º–µ—Ç—Ä–∏—á–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ –ø–∞–º—è—Ç–∏)
* –ü–æ–¥–¥–µ—Ä–∂–∫–∞ Huge Pages
* –ü—Ä–∏–≤—è–∑–∫–∞ —Å—Ç—Ä–∞–Ω–∏—Ü –∫ —è–¥—Ä–∞–º (Affinity)

---

### –†–æ–ª—å BIOS/UEFI

* –ü–æ–ª—É—á–∞–µ–º –∫–∞—Ä—Ç—É –ø–∞–º—è—Ç–∏ —á–µ—Ä–µ–∑ BIOS (e820) –∏–ª–∏ UEFI (UEFI memory map)
* –¢–æ–ª—å–∫–æ –¥–æ–ø—É—Å—Ç–∏–º—ã–µ –æ–±–ª–∞—Å—Ç–∏ –º–æ–≥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –ø–æ–¥ –∞–ª–ª–æ–∫–∞—Ü–∏—é

---

## üìò –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã:

* Intel¬Æ SDM Volume 3A: Physical Memory Management
* AMD64 Architecture Programmer‚Äôs Manual Vol. 2
* ‚ÄúOperating Systems: Three Easy Pieces‚Äù ‚Äî –≥–ª–∞–≤—ã –ø—Ä–æ –ø–∞–º—è—Ç—å
* –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ e820, UEFI memory map
* –ò—Å—Ö–æ–¥–Ω–∏–∫–∏ Linux: `mm/page_alloc.c`, `mm/init.c`

---

## üí° –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ:

üî® –ó–∞–¥–∞—á–∏:

1. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –±–∏—Ç–æ–≤–æ–π –∫–∞—Ä—Ç—ã
2. –ó–∞–ø–æ–ª–Ω–∏—Ç—å –∫–∞—Ä—Ç—É –Ω–∞ –æ—Å–Ω–æ–≤–µ e820 (–∏–ª–∏ —ç–º—É–ª–∏—Ä–æ–≤–∞—Ç—å –≤—Ä—É—á–Ω—É—é –≤ QEMU)
3. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏:

   * `alloc_frame()`
   * `free_frame(frame_id)`
   * `is_frame_free(frame_id)`
4. –í—ã–¥–µ–ª–∏—Ç—å –ø–µ—Ä–≤—ã–µ 10 —Å—Ç—Ä–∞–Ω–∏—Ü –∏ –≤—ã–≤–µ—Å—Ç–∏ –∏—Ö –Ω–æ–º–µ—Ä–∞

---

## üíª –ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞ –Ω–∞ C23:

```c
#include <stdint.h>
#include <stdbool.h>
#include <stdio.h>
#include <string.h>

#define TOTAL_FRAMES 262144  // 1–ì–ë / 4–ö–ë
#define BITMAP_SIZE (TOTAL_FRAMES / 8)

uint8_t frame_bitmap[BITMAP_SIZE];

// –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –±–∏—Ç (–∑–∞–Ω—è—Ç—å —Ñ—Ä–µ–π–º)
void set_frame(uint32_t frame) {
    frame_bitmap[frame / 8] |= (1 << (frame % 8));
}

// –°–±—Ä–æ—Å–∏—Ç—å –±–∏—Ç (–æ—Å–≤–æ–±–æ–¥–∏—Ç—å —Ñ—Ä–µ–π–º)
void clear_frame(uint32_t frame) {
    frame_bitmap[frame / 8] &= ~(1 << (frame % 8));
}

// –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —Å–≤–æ–±–æ–¥–µ–Ω –ª–∏ —Ñ—Ä–µ–π–º
bool is_frame_free(uint32_t frame) {
    return !(frame_bitmap[frame / 8] & (1 << (frame % 8)));
}

// –ù–∞–π—Ç–∏ –∏ –∞–ª–ª–æ—Ü–∏—Ä–æ–≤–∞—Ç—å —Å–≤–æ–±–æ–¥–Ω—ã–π —Ñ—Ä–µ–π–º
int alloc_frame() {
    for (uint32_t i = 0; i < TOTAL_FRAMES; i++) {
        if (is_frame_free(i)) {
            set_frame(i);
            return i;
        }
    }
    return -1;  // –Ω–µ—Ç —Å–≤–æ–±–æ–¥–Ω–æ–π –ø–∞–º—è—Ç–∏
}
```

üß™ –î–æ–±–∞–≤—å—Ç–µ –ª–æ–≥: –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∞–ª–ª–æ—Ü–∏—Ä–æ–≤–∞–Ω–∏–∏ —Ñ—Ä–µ–π–º–∞ –≤—ã–≤–æ–¥–∏—Ç–µ –µ–≥–æ –Ω–æ–º–µ—Ä. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ.

---

## üß† –£—Ä–æ–≤–µ–Ω—å —Å–ª–æ–∂–Ω–æ—Å—Ç–∏: 7.5/10

---

## ‚è± –í—Ä–µ–º—è –Ω–∞ –∏–∑—É—á–µ–Ω–∏–µ: 7 —á–∞—Å–æ–≤

* –¢–µ–æ—Ä–∏—è: 4 —á
* –ü—Ä–∞–∫—Ç–∏–∫–∞: 3 —á

---

## üßë‚Äçüè´ –ú–µ—Ç–æ–¥–∏–∫–∞ –ø—Ä–µ–ø–æ–¥–∞–≤–∞–Ω–∏—è:

* –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –±–∏—Ç–æ–≤–æ–π –∫–∞—Ä—Ç—ã
* –õ–µ–∫—Ü–∏—è —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏ –∏–∑ BIOS/UEFI e820
* –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Å —ç–º—É–ª—è—Ü–∏–µ–π QEMU: —Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏
* –î–æ–º–∞—à–∫–∞: —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∫–æ–º–ø–∞–∫—Ç–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä —Ñ–∏–∑–∏—á–µ—Å–∫–æ–π –ø–∞–º—è—Ç–∏ + —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ QEMU

---

üéâ –ì–æ—Ç–æ–≤ –¥–≤–∏–≥–∞—Ç—å—Å—è –¥–∞–ª—å—à–µ? –°–∫–∞–∂–∏ **–¥–∞–¥–∞**, –∏ –º—ã –ø—Ä–æ–¥–æ–ª–∂–∏–º –∫ **—É—Ä–æ–∫—É 24**, –≥–¥–µ –Ω–∞—á–Ω–µ–º —Å–≤—è–∑—ã–≤–∞—Ç—å —Ñ–∏–∑–∏—á–µ—Å–∫—É—é –∏ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—É—é –ø–∞–º—è—Ç—å —á–µ—Ä–µ–∑ –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—É—é —Å–∏—Å—Ç–µ–º—É –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–π! üß†üì¶üìç
