–û—Ç–ª–∏—á–Ω–æ, –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º!

---

# üîπ –£—Ä–æ–∫ 7. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏—è–º–∏ –≤ x86: –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏—è –∏ –∏—Å–∫–ª—é—á–µ–Ω–∏—è ‚ö°üõ°Ô∏è

---

## üß© –¢–µ–º–∞ —É—Ä–æ–∫–∞:

–ü–æ–≥—Ä—É–∂–∞–µ–º—Å—è –≤ –º–∏—Ä –∞–ø–ø–∞—Ä–∞—Ç–Ω—ã—Ö –∏ –ø—Ä–æ–≥—Ä–∞–º–º–Ω—ã—Ö –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏–π –≤ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ x86. –£–∑–Ω–∞–µ–º, –∫–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –º–µ—Ö–∞–Ω–∏–∑–º –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏–π, –∫–∞–∫ –û–° –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∏—Å–∫–ª—é—á–µ–Ω–∏—è, –∏ –∫–∞–∫ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É –≤–µ–∫—Ç–æ—Ä–æ–≤ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏–π (IDT). –û–±—Å—É–¥–∏–º, –∫–∞–∫ —Å–æ–∑–¥–∞–≤–∞—Ç—å —Å–≤–æ–∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∏ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –∞–ø–ø–∞—Ä–∞—Ç–Ω—ã–µ IRQ.

---

## üß† –¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ (‚âà2500‚Äì3000 —Å–ª–æ–≤)

### –ß—Ç–æ —Ç–∞–∫–æ–µ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏—è –∏ –∏—Å–∫–ª—é—á–µ–Ω–∏—è?

–ü—Ä–µ—Ä—ã–≤–∞–Ω–∏—è ‚Äî —ç—Ç–æ —Å–∏–≥–Ω–∞–ª –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä—É, –∫–æ—Ç–æ—Ä—ã–π –≤—Ä–µ–º–µ–Ω–Ω–æ –ø—Ä–µ—Ä—ã–≤–∞–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–π –ø—Ä–æ–≥—Ä–∞–º–º—ã –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤–∞–∂–Ω–æ–≥–æ —Å–æ–±—ã—Ç–∏—è. –ò—Å–∫–ª—é—á–µ–Ω–∏—è ‚Äî —ç—Ç–æ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏—è, –≤—ã–∑–≤–∞–Ω–Ω—ã–µ –æ—à–∏–±–∫–∞–º–∏ –∏–ª–∏ –æ—Å–æ–±–µ–Ω–Ω—ã–º–∏ —É—Å–ª–æ–≤–∏—è–º–∏, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–æ–∏—Å—Ö–æ–¥—è—Ç –≤–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–∞–º–º—ã.

---

### –¢–∏–ø—ã –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏–π –≤ x86:

* **–ê–ø–ø–∞—Ä–∞—Ç–Ω—ã–µ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏—è**: –ø–æ—Å—Ç—É–ø–∞—é—Ç –æ—Ç –≤–Ω–µ—à–Ω–∏—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞, —Ç–∞–π–º–µ—Ä) —á–µ—Ä–µ–∑ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏–π PIC –∏–ª–∏ APIC.
* **–ü—Ä–æ–≥—Ä–∞–º–º–Ω—ã–µ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏—è**: –≤—ã–∑—ã–≤–∞—é—Ç—Å—è –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ, –Ω–∞–ø—Ä–∏–º–µ—Ä, —á–µ—Ä–µ–∑ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é `INT` –¥–ª—è —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤.
* **–ò—Å–∫–ª—é—á–µ–Ω–∏—è**: –æ—à–∏–±–∫–∏ –≤ —Ä–∞–±–æ—Ç–µ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞, –Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–µ–ª–µ–Ω–∏–µ –Ω–∞ –Ω–æ–ª—å, —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç, –æ—à–∏–±–∫–∞ —Å—Ç–µ–∫–∞.

---

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏–π:

* –í x86 –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **IDT (Interrupt Descriptor Table)** ‚Äî —Ç–∞–±–ª–∏—Ü–∞ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–æ–≤ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏–π, –∞–Ω–∞–ª–æ–≥–∏—á–Ω–∞—è GDT, –Ω–æ –¥–ª—è –≤–µ–∫—Ç–æ—Ä–æ–≤ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏–π.
* –ö–∞–∂–¥—ã–π –≤–µ–∫—Ç–æ—Ä IDT —É–∫–∞–∑—ã–≤–∞–µ—Ç –∞–¥—Ä–µ—Å –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ (ISR ‚Äì Interrupt Service Routine).
* IDT –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –≤ —Ä–µ–≥–∏—Å—Ç—Ä `IDTR`.

---

### –§–æ—Ä–º–∞—Ç –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–∞ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏—è

* 8 –±–∞–π—Ç
* –°–æ–¥–µ—Ä–∂–∏—Ç –∞–¥—Ä–µ—Å –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞, —Å–µ–ª–µ–∫—Ç–æ—Ä —Å–µ–≥–º–µ–Ω—Ç–∞ –∫–æ–¥–∞, —Ç–∏–ø –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏—è –∏ –∞—Ç—Ä–∏–±—É—Ç—ã –¥–æ—Å—Ç—É–ø–∞
* –†–∞–∑–ª–∏—á–∞—é—Ç—Å—è –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä—ã: –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏—è, –∏—Å–∫–ª—é—á–µ–Ω–∏—è, –ª–æ–≤—É—à–∫–∏

---

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏—è–º–∏ –≤ –û–°

* –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è IDT
* –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤
* –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ –∏ –º–∞—Å–∫–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏–π –≤ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–µ PIC/APIC
* –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞–º–∏

---

### –ò—Å–∫–ª—é—á–µ–Ω–∏—è –≤ –û–°

* –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ CPU: –¥–µ–ª–µ–Ω–∏–µ –Ω–∞ 0, –Ω–∞—Ä—É—à–µ–Ω–∏–µ –∑–∞—â–∏—Ç—ã, —Å—Ç—Ä–∞–Ω–∏—á–Ω–∞—è –æ—à–∏–±–∫–∞
* –ú–µ—Ö–∞–Ω–∏–∑–º—ã –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –ø–æ—Å–ª–µ –∏—Å–∫–ª—é—á–µ–Ω–∏–π
* –ñ—É—Ä–Ω–∞–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –æ—à–∏–±–æ–∫

---

### –ê–ø–ø–∞—Ä–∞—Ç–Ω—ã–µ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏–π

* **PIC (Programmable Interrupt Controller):** –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä
* **APIC (Advanced Programmable Interrupt Controller):** —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –º—É–ª—å—Ç–∏–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä—ã
* –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏ IRQ

---

### –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–¥–∞—á–∏

* –°–æ–∑–¥–∞—Ç—å –∏ –∑–∞–≥—Ä—É–∑–∏—Ç—å IDT
* –ù–∞–ø–∏—Å–∞—Ç—å –±–∞–∑–æ–≤—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏–π (—Ç–∞–π–º–µ—Ä, –∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞)
* –ù–∞—Å—Ç—Ä–æ–∏—Ç—å PIC –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏—è–º–∏
* –û–±—Ä–∞–±–æ—Ç–∞—Ç—å –∏—Å–∫–ª—é—á–µ–Ω–∏–µ –¥–µ–ª–µ–Ω–∏—è –Ω–∞ 0

---

### –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ç—Ä–µ–Ω–¥—ã 2025 –≥–æ–¥–∞

* –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ MSI/MSI-X ‚Äî —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏–π –¥–ª—è PCIe —É—Å—Ç—Ä–æ–π—Å—Ç–≤
* –í–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏–π –≤ –≥–∏–ø–µ—Ä–≤–∏–∑–æ—Ä–∞—Ö
* –ë–µ–∑–æ–ø–∞—Å–Ω—ã–µ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π Intel CET –∏ ARM Pointer Authentication

---

## üìò –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã:

* Intel¬Æ 64 and IA-32 Architectures Software Developer‚Äôs Manual, Volume 3 ‚Äî —Ä–∞–∑–¥–µ–ª Interrupts and Exceptions
* OSDev wiki: Interrupts ([—Å—Å—ã–ª–∫–∞](https://wiki.osdev.org/Interrupts))
* –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ PIC –∏ APIC
* –°—Ç–∞—Ç—å–∏ –ø—Ä–æ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏—è MSI/MSI-X

---

## üí° –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–º–µ—Ä—ã:

* –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è IDT —Å 256 –≤–µ–∫—Ç–æ—Ä–∞–º–∏
* –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–≥–æ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏—è (int 0x80)
* –ù–∞—Å—Ç—Ä–æ–π–∫–∞ PIC –¥–ª—è —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏–π –æ—Ç –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã –∏ —Ç–∞–π–º–µ—Ä–∞

---

## üíª –ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞ –Ω–∞ –°–∏23:

```c
#include <stdint.h>

// –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–∞ IDT
struct IDTEntry {
    uint16_t offset_low;
    uint16_t selector;
    uint8_t zero;
    uint8_t type_attr;
    uint16_t offset_high;
} __attribute__((packed));

struct IDTPtr {
    uint16_t limit;
    uint32_t base;
} __attribute__((packed));

#define IDT_SIZE 256
struct IDTEntry idt[IDT_SIZE];
struct IDTPtr idt_ptr;

extern void idt_load(uint32_t);

void set_idt_entry(int n, uint32_t handler_addr, uint16_t selector, uint8_t flags) {
    idt[n].offset_low = handler_addr & 0xFFFF;
    idt[n].selector = selector;
    idt[n].zero = 0;
    idt[n].type_attr = flags;
    idt[n].offset_high = (handler_addr >> 16) & 0xFFFF;
}

void init_idt() {
    idt_ptr.limit = sizeof(idt) - 1;
    idt_ptr.base = (uint32_t)&idt;

    for (int i = 0; i < IDT_SIZE; i++) {
        set_idt_entry(i, 0, 0x08, 0x8E); // –ó–∞–≥–ª—É—à–∫–∞
    }

    idt_load((uint32_t)&idt_ptr);
}

// –ü—Ä–∏–º–µ—Ä –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏—è
__attribute__((interrupt))
void timer_handler(void* frame) {
    // –ó–¥–µ—Å—å –º–æ–∂–Ω–æ —É–≤–µ–ª–∏—á–∏—Ç—å —Å—á–µ—Ç—á–∏–∫ —Ç–∏–∫–æ–≤, –æ—Ç–ø—Ä–∞–≤–∏—Ç—å EOI –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—É PIC –∏ —Ç.–¥.
}

int main() {
    init_idt();
    // –î–∞–ª–µ–µ –Ω—É–∂–Ω–æ –≤–∫–ª—é—á–∏—Ç—å –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏—è –∏ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å PIC
    return 0;
}
```

---

## üß† –£—Ä–æ–≤–µ–Ω—å —Å–ª–æ–∂–Ω–æ—Å—Ç–∏: 8/10

---

## ‚è± –í—Ä–µ–º—è –Ω–∞ –∏–∑—É—á–µ–Ω–∏–µ: 8‚Äì10 —á–∞—Å–æ–≤

* –¢–µ–æ—Ä–∏—è: 6 —á
* –ü—Ä–∞–∫—Ç–∏–∫–∞: 2‚Äì4 —á

---

## üßë‚Äçüè´ –ú–µ—Ç–æ–¥–∏–∫–∞:

* –õ–µ–∫—Ü–∏—è —Å –ø–æ–¥—Ä–æ–±–Ω—ã–º —Ä–∞–∑–±–æ—Ä–æ–º –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏–π –∏ –∏—Å–∫–ª—é—á–µ–Ω–∏–π
* –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è —Ä–∞–±–æ—Ç—ã —Å IDT –∏ PIC
* –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è —Ä–∞–±–æ—Ç–∞ —Å –Ω–∞–ø–∏—Å–∞–Ω–∏–µ–º ISR
* –î–æ–º–∞—à–Ω–µ–µ –∑–∞–¥–∞–Ω–∏–µ: —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã

---

üî• –ì–æ—Ç–æ–≤ –¥–≤–∏–≥–∞—Ç—å—Å—è –¥–∞–ª—å—à–µ? –ù–∞–ø–∏—à–∏ **–¥–∞**!
