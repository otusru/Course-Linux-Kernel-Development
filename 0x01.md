# Курс: Разработка ядра Linux

---

## Часть 1: Введение в ядро Linux

**Рекомендуемое время:** 6 часов

### Темы:

* Что такое ядро Linux?
* История и эволюция ядра Linux
* Лицензирование и сообщество разработчиков
* Архитектура ядра: монолитное ядро
* Роль ядра в операционной системе
* Основные компоненты ядра Linux
* Процесс загрузки системы и роль ядра
* Установка и настройка Linux для разработки ядра
* Обзор и структура исходного кода ядра Linux

### Лабораторные задания:

* Установка Linux и настройка окружения для разработки ядра
* Загрузка исходного кода ядра
* Ознакомление со структурой исходников и составление краткого отчёта

### Чек-лист:

* [ ] Установлена и настроена Linux-система для разработки ядра
* [ ] Исходный код ядра успешно загружен
* [ ] Понимается базовая структура исходного кода
* [ ] Составлен отчет по ключевым компонентам ядра

---

## Часть 2: Основы разработки модулей ядра

**Рекомендуемое время:** 8 часов

### Темы:

* Что такое модули ядра?
* Создание и сборка простого модуля ядра
* Загрузка/выгрузка модулей, использование printk
* Макросы \_\_init и \_\_exit
* Передача параметров командной строки
* Модули из нескольких файлов
* Makefile для модулей
* Документирование модулей
* Отладка модулей с dmesg

### Лабораторные задания:

* Создать и собрать простой модуль "Hello World"
* Использовать параметры командной строки
* Создать модуль из нескольких файлов
* Настроить Makefile
* Отладить модуль и проанализировать логи dmesg

### Чек-лист:

* [ ] Модуль создан и успешно загружен в ядро
* [ ] Параметры командной строки работают корректно
* [ ] Makefile работает с несколькими исходниками
* [ ] Логи printk отображаются в dmesg
* [ ] Модуль корректно выгружается

---

## Часть 3: Основы системного программирования

**Рекомендуемое время:** 10 часов

### Темы:

* Системные вызовы Linux
* Создание и управление процессами
* Планирование процессов и приоритеты
* Управление памятью в пользовательском пространстве
* Работа с файлами через системные вызовы
* Обработка сигналов
* Межпроцессное взаимодействие (IPC)
* Потоки и синхронизация
* Обработка ошибок
* Отладка с gdb

### Лабораторные задания:

* Создать программу с несколькими процессами
* Использовать системные вызовы для файловых операций
* Реализовать обработчики сигналов
* Применить межпроцессное взаимодействие (пайпы, сокеты)
* Написать многопоточное приложение с mutex
* Отладить приложение через gdb

### Чек-лист:

* [ ] Программа использует fork()
* [ ] Системные вызовы для работы с файлами применены
* [ ] Сигналы корректно обрабатываются
* [ ] IPC работает между процессами
* [ ] Потоки и синхронизация реализованы
* [ ] Произведена успешная отладка через gdb

---

## Часть 4: Разработка драйверов устройств

**Рекомендуемое время:** 12 часов

### Темы:

* Что такое драйверы устройств?
* Типы драйверов: символьные, блочные, сетевые
* Создание драйвера символьного устройства
* Структура file\_operations и её использование
* Регистрация и удаление устройств
* Операции чтения и записи
* Управление устройствами через ioctl
* Работа с буферами и кэшированием данных
* Обработка ошибок в драйверах
* Тестирование и отладка драйверов

### Лабораторные задания:

* Создать символьный драйвер устройства "Hello Device"
* Реализовать file\_operations: open, read, write, release
* Реализовать ioctl команды для управления устройством
* Протестировать драйвер с помощью пользовательской программы
* Отладить драйвер, используя printk и dmesg
* Обработать ошибки и проверить корректность выгрузки драйвера

### Чек-лист:

* [ ] Символьный драйвер успешно компилируется и загружается
* [ ] Реализованы основные методы file\_operations
* [ ] ioctl команды корректно обрабатываются
* [ ] Пользовательская программа взаимодействует с драйвером
* [ ] Драйвер устойчив к ошибкам и корректно выгружается

---

## Часть 5: Архитектура ядра Linux

**Рекомендуемое время:** 14 часов

### Темы:

* Общий обзор архитектуры ядра
* Инициализация ядра и процесс загрузки
* Управление процессами: task\_struct и планировщик
* Механизмы синхронизации: spinlocks, семафоры, mutexes
* Обработка прерываний и исключений
* Управление памятью в ядре: kmalloc, vmalloc, mmap
* Основные структуры данных ядра: списки, хеш-таблицы, деревья
* Виртуальная файловая система (VFS)
* Блочный и символьный ввод/вывод
* Сетевой стек ядра

### Лабораторные задания:

* Анализ структуры task\_struct в исходниках ядра
* Реализация примера использования spinlock
* Работа с kmalloc и vmalloc: написание кода выделения и освобождения памяти
* Исследование работы VFS на простом примере
* Просмотр логов сетевого стека ядра

### Чек-лист:

* [ ] Понимание процесса инициализации ядра
* [ ] Реализованы и протестированы синхронизационные примитивы
* [ ] Понимание структуры task\_struct
* [ ] Понимание и работа с памятью ядра
* [ ] Знакомство с VFS и файловыми операциями в ядре

---

## Часть 6: Работа с прерываниями и таймерами

**Рекомендуемое время:** 10 часов

### Темы:

* Аппаратные прерывания и обработчики
* Регистрация/удаление обработчиков прерываний
* Softirq и tasklets
* Таймеры в ядре Linux
* Синхронизация в обработчиках прерываний
* Workqueues для отложенных задач
* Отладка прерываний и таймеров
* Многозадачность и планирование
* Приоритеты задач и реализация систем реального времени

### Лабораторные задания:

* Написать обработчик аппаратного прерывания (например, для виртуального устройства)
* Использовать softirq и tasklets для отложенной обработки
* Реализовать таймер и проверить его работу
* Использовать workqueue для выполнения задач в контексте процесса
* Настроить приоритеты задач и проследить поведение планировщика

### Чек-лист:

* [ ] Реализован и отлажен обработчик прерываний
* [ ] Использованы softirq/tasklets и workqueues
* [ ] Таймеры корректно запускаются и завершаются
* [ ] Продемонстрирована работа планировщика с приоритетами
* [ ] Понимание механизмов синхронизации при прерываниях

---

## Часть 7: Управление памятью в ядре

**Рекомендуемое время:** 12 часов

### Темы:

* Структуры управления памятью: page, slab, buddy
* Выделение и освобождение памяти: kmalloc, vmalloc
* Управление страницами памяти и свопинг
* Перераспределение памяти, дефрагментация
* Использование percpu-данных
* Механизмы кэширования и буферизации
* Обработка ошибок при управлении памятью
* Оптимизация использования памяти
* Инструменты мониторинга памяти (vmstat, slabtop)
* Отладка проблем с памятью

### Лабораторные задания:

* Написать модуль, демонстрирующий работу kmalloc/vmalloc
* Исследовать и проанализировать работу buddy allocator
* Использовать percpu-память в примере модуля
* Профилировать использование памяти с помощью slabtop
* Реализовать простой механизм кэширования в модуле

### Чек-лист:

* [ ] Работа kmalloc и vmalloc изучена и продемонстрирована
* [ ] Понимание механизмов распределения страниц
* [ ] Реализовано и протестировано использование percpu-данных
* [ ] Понимание и использование инструментов мониторинга памяти
* [ ] Оптимизировано использование памяти в примерах
