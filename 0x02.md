## Часть 11: Системы файлов и VFS

**Рекомендуемое время:** 8 часов

### Темы:

* Введение в виртуальную файловую систему (VFS)
* Структуры данных VFS: inode, dentry, super\_block
* Работа с файловыми системами в ядре
* Монтирование и размонтирование файловых систем
* Кэширование данных в VFS
* Создание простого файлового драйвера (pseudo-файловая система)

### Лабораторные задания:

* Исследовать и отобразить структуру VFS через /proc и debugfs
* Реализовать простую pseudo-файловую систему, поддерживающую чтение/запись
* Написать модуль, создающий виртуальные файлы с динамическим содержимым
* Проанализировать процессы монтирования и размонтирования файловых систем
* Использовать инструменты мониторинга для оценки кэширования VFS

### Чек-лист:

* [ ] Понимание структур VFS и их ролей
* [ ] Реализован и загружен модуль с pseudo-фс
* [ ] Динамические виртуальные файлы успешно работают
* [ ] Процесс монтирования и размонтирования изучен
* [ ] Использованы инструменты мониторинга кэша VFS

---

## Часть 12: Блочные устройства и драйверы

**Рекомендуемое время:** 9 часов

### Темы:

* Введение в блочные устройства
* Структура и регистрация блочного драйвера
* Очередь запросов (request queue) и управление I/O
* Буферизация и кэширование блочных данных
* Создание простого блочного драйвера
* Работа с дисковыми устройствами и partitioning

### Лабораторные задания:

* Изучить существующий блочный драйвер в ядре (например, ramdisk)
* Реализовать и загрузить простой блочный драйвер с минимальной функциональностью
* Написать обработку запросов на чтение и запись
* Проанализировать работу буфера и кэша в блочных драйверах
* Использовать инструменты для тестирования I/O и производительности

### Чек-лист:

* [ ] Понять структуру и работу блочных драйверов
* [ ] Создать и загрузить базовый блочный драйвер
* [ ] Реализовать обработку запросов I/O
* [ ] Оценить работу кэширования блочных данных
* [ ] Использовать инструменты для тестирования производительности

---

## Часть 13: Сетевые подсистемы ядра

**Рекомендуемое время:** 10 часов

### Темы:

* Обзор сетевой архитектуры Linux ядра
* Сетевые интерфейсы и протоколы
* Работа с сокетами в ядре
* Создание простого сетевого драйвера
* Фильтрация и обработка пакетов (netfilter, nftables)
* Основы реализации TCP/IP стека в ядре

### Лабораторные задания:

* Исследовать существующие сетевые драйверы и модули
* Реализовать простой драйвер виртуального сетевого интерфейса
* Написать модуль фильтрации пакетов с использованием netfilter hooks
* Использовать инструменты tcpdump и wireshark для анализа трафика
* Проанализировать работу TCP/IP стека через трассировку

### Чек-лист:

* [ ] Изучена архитектура сетевых подсистем
* [ ] Создан и протестирован простой сетевой драйвер
* [ ] Написан модуль фильтрации пакетов
* [ ] Использованы сетевые анализаторы трафика
* [ ] Поняты основы TCP/IP стека в ядре

---

## Часть 14: Виртуализация и взаимодействие с аппаратурой

**Рекомендуемое время:** 9 часов

### Темы:

* Основы виртуализации на уровне ядра
* KVM (Kernel-based Virtual Machine) архитектура
* Взаимодействие с аппаратным обеспечением: MMIO, DMA
* Работа с PCI и USB устройствами
* Использование I/O Memory Management Unit (IOMMU)
* Драйверы для виртуальных устройств

### Лабораторные задания:

* Запустить и настроить виртуальную машину через KVM
* Написать драйвер для простого PCI-устройства
* Использовать средства трассировки для анализа работы DMA
* Реализовать простой драйвер виртуального устройства (например, virtio)
* Проанализировать взаимодействие драйвера с аппаратурой через MMIO

### Чек-лист:

* [ ] Настроена и запущена виртуальная машина через KVM
* [ ] Создан драйвер для PCI устройства
* [ ] Проанализирована работа DMA
* [ ] Реализован драйвер виртуального устройства
* [ ] Изучены механизмы MMIO и IOMMU

---

## Часть 15: Планирование задач и синхронизация

**Рекомендуемое время:** 8 часов

### Темы:

* Планировщик задач в Linux
* Приоритеты и политики планирования
* Примитивы синхронизации: mutex, spinlock, semaphore
* Блокировки чтения/записи (rwlocks)
* Синхронизация в прерываниях и многопоточности
* Анализ и устранение гонок данных

### Лабораторные задания:

* Изучить работу планировщика с помощью инструментов perf и sched-debug
* Реализовать модуль с разными примитивами синхронизации
* Проанализировать гонки данных и использовать инструменты для их выявления (например, kmemcheck)
* Написать тестовые сценарии с конкурентным доступом к ресурсам
* Оптимизировать синхронизацию для уменьшения задержек

### Чек-лист:

* [ ] Понять работу планировщика и политик
* [ ] Реализованы и протестированы примитивы синхронизации
* [ ] Выявлены и исправлены гонки данных
* [ ] Использованы инструменты диагностики синхронизации
* [ ] Оптимизирована производительность

---

## Часть 16: Отладка и тестирование ядра

**Рекомендуемое время:** 8 часов

### Темы:

* Основы отладки ядра (kgdb, kdump)
* Использование printk и системных логов
* Трассировка с ftrace и perf
* Тестирование драйверов и модулей ядра
* Использование систем автоматического тестирования (kselftest)
* Анализ дампов памяти и журналов

### Лабораторные задания:

* Настроить kgdb для удалённой отладки ядра
* Собрать и проанализировать дамп ядра после краша (kdump)
* Написать тесты для модуля ядра с использованием kselftest
* Использовать ftrace и perf для сбора и анализа данных
* Проанализировать логи ядра и выявить ошибки

### Чек-лист:

* [ ] Настроена и использована отладка ядра (kgdb, kdump)
* [ ] Написаны и выполнены тесты модулей ядра
* [ ] Проведена трассировка с использованием ftrace/perf
* [ ] Анализированы логи и дампы ядра
* [ ] Понимание процессов тестирования ядра

---

## Часть 17: Управление энергопотреблением

**Рекомендуемое время:** 6 часов

### Темы:

* Основы энергоменеджмента в ядре Linux
* Подсистемы cpuidle и cpufreq
* Работа с устройствами и энергопотреблением
* Power states и переходы между ними
* Использование энергомониторов и профилирование
* Разработка драйверов с поддержкой энергосбережения

### Лабораторные задания:

* Изучить состояние энергопотребления системы с помощью powertop
* Настроить cpufreq и cpuidle для разных режимов работы
* Реализовать поддержку энергосбережения в драйвере устройства
* Проанализировать энергопотребление при разных сценариях нагрузки
* Использовать инструменты профилирования энергопотребления

### Чек-лист:

* [ ] Понять механизмы энергоменеджмента в ядре
* [ ] Настроены подсистемы cpufreq и cpuidle
* [ ] Драйвер поддерживает энергосбережение
* [ ] Проведен анализ энергопотребления
* [ ] Использованы инструменты профилирования энергии

---

## Часть 18: Расширенное взаимодействие с пользователем

**Рекомендуемое время:** 7 часов

### Темы:

* Взаимодействие ядра и пространства пользователя
* Работа с netlink-сокетами
* Использование debugfs и sysfs
* Реализация интерфейсов для настройки драйверов
* Передача данных между ядром и пользователем
* Безопасность взаимодействия с пользователем

### Лабораторные задания:

* Написать модуль с интерфейсом в sysfs для конфигурации
* Использовать debugfs для вывода отладочной информации
* Реализовать коммуникацию через netlink между модулем и пользовательским процессом
* Написать клиентское приложение для взаимодействия с модулем
* Проверить безопасность и ограничения взаимодействия

### Чек-лист:

* [ ] Реализован интерфейс sysfs и debugfs
* [ ] Настроена коммуникация netlink
* [ ] Написано клиентское приложение
* [ ] Проанализирована безопасность взаимодействия
* [ ] Проверена передача данных между ядром и пользователем

---

## Часть 19: Разработка и оптимизация подсистемы ввода-вывода

**Рекомендуемое время:** 8 часов

### Темы:

* Архитектура подсистемы ввода-вывода (I/O)
* Типы устройств ввода-вывода
* Асинхронный ввод-вывод
* Буферизация и кеширование I/O
* Оптимизация производительности I/O
* Обработка ошибок и повторные попытки

### Лабораторные задания:

* Изучить реализацию асинхронного ввода-вывода в ядре
* Реализовать простой драйвер с поддержкой асинхронного I/O
* Проанализировать влияние буферизации на производительность
* Оптимизировать драйвер для минимизации задержек
* Проверить обработку ошибок в драйвере

### Чек-лист:

* [ ] Понять архитектуру I/O подсистемы
* [ ] Реализован драйвер с асинхронным вводом-выводом
* [ ] Проведен анализ и оптимизация буферизации
* [ ] Обеспечена корректная обработка ошибок
* [ ] Оценена производительность драйвера

---

## Часть 20: Кросс-компиляция и сборка ядра для встроенных систем

**Рекомендуемое время:** 7 часов

### Темы:

* Особенности кросс-компиляции ядра Linux
* Настройка инструментальных цепочек (toolchains)
* Сборка ядра для различных архитектур
* Конфигурация и оптимизация ядра для embedded-систем
* Работа с rootfs и initramfs
* Загрузка и отладка на целевом устройстве

### Лабораторные задания:

* Настроить кросс-компилятор для выбранной архитектуры (ARM, MIPS и др.)
* Собрать и сконфигурировать ядро для embedded-устройства
* Создать rootfs и initramfs для загрузки
* Записать и загрузить образ на целевое устройство
* Провести базовую отладку и проверить работоспособность

### Чек-лист:

* [ ] Настроен кросс-компилятор
* [ ] Собрано ядро и rootfs для embedded-системы
* [ ] Успешно загружено и запущено на целевом устройстве
* [ ] Проведена базовая отладка работы ядра
* [ ] Поняты особенности кросс-компиляции

---
