–û—Ç–ª–∏—á–Ω–æ! –ü–æ–≥—Ä—É–∂–∞–µ–º—Å—è –≤ –º–∏—Ä —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤! üöÄ‚ú®

---

### üîπ –£—Ä–æ–∫ 10. –°–∏—Å—Ç–µ–º–Ω—ã–µ –≤—ã–∑–æ–≤—ã: –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –º–µ–∂–¥—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º –∏ —è–¥—Ä–æ–º –û–°

---

**–û–ø–∏—Å–∞–Ω–∏–µ:**
–°–∏—Å—Ç–µ–º–Ω—ã–µ –≤—ã–∑–æ–≤—ã ‚Äî —ç—Ç–æ –º–æ—Å—Ç –º–µ–∂–¥—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º –∏ —è–¥—Ä–æ–º –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã. –û–Ω–∏ –ø–æ–∑–≤–æ–ª—è—é—Ç –ø—Ä–æ–≥—Ä–∞–º–º–∞–º –≤—ã–ø–æ–ª–Ω—è—Ç—å –∑–∞—â–∏—â—ë–Ω–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏, –Ω–∞–ø—Ä–∏–º–µ—Ä, —Ä–∞–±–æ—Ç—É —Å —Ñ–∞–π–ª–∞–º–∏, –ø–∞–º—è—Ç—å—é –∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏, –ø—Ä–∏ —ç—Ç–æ–º —è–¥—Ä–æ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å —Å–∏—Å—Ç–µ–º—ã. –í —ç—Ç–æ–º —É—Ä–æ–∫–µ –º—ã –∏–∑—É—á–∏–º –º–µ—Ö–∞–Ω–∏–∑–º—ã –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤, –∫–∞–∫ –∏—Ö –≤—ã–∑—ã–≤–∞—Ç—å –∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –Ω–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ x86-64.

–û—Å–Ω–æ–≤–Ω—ã–µ —Ç–µ–º—ã:

* –ß—Ç–æ —Ç–∞–∫–æ–µ —Å–∏—Å—Ç–µ–º–Ω—ã–µ –≤—ã–∑–æ–≤—ã –∏ –∑–∞—á–µ–º –æ–Ω–∏ –Ω—É–∂–Ω—ã
* –ê–ø–ø–∞—Ä–∞—Ç–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤ (–∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ syscall/sysret)
* –¢–∞–±–ª–∏—Ü–∞ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤ –∏ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤
* –ü–µ—Ä–µ–¥–∞—á–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∏ –≤–æ–∑–≤—Ä–∞—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
* –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∏ –∑–∞—â–∏—Ç–∞ —è–¥—Ä–∞

---

### –ü—Ä–∏–º–µ—Ä –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –∫–æ–¥–∞ (syscall/syscall.c)

```c
#include <stdint.h>

typedef uint64_t (*syscall_func_t)(uint64_t, uint64_t, uint64_t);

uint64_t sys_write(uint64_t fd, uint64_t buf_ptr, uint64_t len);

syscall_func_t syscall_table[] = {
    0,          // syscall 0 - reserved
    sys_write,  // syscall 1 - write
    // –¥–æ–±–∞–≤–∏—Ç—å –¥—Ä—É–≥–∏–µ –≤—ã–∑–æ–≤—ã
};

uint64_t syscall_handler(uint64_t syscall_num, uint64_t arg1, uint64_t arg2)
{
    if(syscall_num >= sizeof(syscall_table) / sizeof(syscall_func_t) || !syscall_table[syscall_num])
        return -1; // –æ—à–∏–±–∫–∞: –Ω–µ—Ç —Ç–∞–∫–æ–≥–æ –≤—ã–∑–æ–≤–∞

    return syscall_table[syscall_num](arg1, arg2, 0);
}

uint64_t sys_write(uint64_t fd, uint64_t buf_ptr, uint64_t len)
{
    // –ó–¥–µ—Å—å –ø—Ä–æ—Å—Ç–æ–π –≤—ã–≤–æ–¥ –≤ –∫–æ–Ω—Å–æ–ª—å, fd –∏–≥–Ω–æ—Ä–∏—Ä—É–µ–º
    char* buf = (char*)buf_ptr;
    for(uint64_t i = 0; i < len; i++)
    {
        // –§—É–Ω–∫—Ü–∏—è –≤—ã–≤–æ–¥–∞ —Å–∏–º–≤–æ–ª–∞ (–ø—Ä–∏–º–µ—Ä)
        console_putc(buf[i]);
    }
    return len;
}
```

---

### –ü–æ—è—Å–Ω–µ–Ω–∏—è:

* –°–∏—Å—Ç–µ–º–Ω—ã–µ –≤—ã–∑–æ–≤—ã –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –≤ –ø—Ä–∏–≤–∏–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω–æ–º —Ä–µ–∂–∏–º–µ —è–¥—Ä–∞.
* –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è `syscall` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø–µ—Ä–µ—Ö–æ–¥–∞ –∏–∑ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ —Ä–µ–∂–∏–º–∞ –≤ —è–¥—Ä–æ.
* –¢–∞–±–ª–∏—Ü–∞ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤ —Å–≤—è–∑—ã–≤–∞–µ—Ç –Ω–æ–º–µ—Ä –≤—ã–∑–æ–≤–∞ —Å —Ñ—É–Ω–∫—Ü–∏–µ–π-–æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–º.
* –ü–µ—Ä–µ–¥–∞—á–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —á–µ—Ä–µ–∑ —Ä–µ–≥–∏—Å—Ç—Ä—ã –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞.
* –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –≤–∞–∂–Ω–∞ –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏.

---

### –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ–µ –∑–∞–¥–∞–Ω–∏–µ:

* –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –±–∞–∑–æ–≤—ã–π –º–µ—Ö–∞–Ω–∏–∑–º —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤ —Å –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–º.
* –°–æ–∑–¥–∞—Ç—å –ø—Ä–∏–º–µ—Ä —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ `write` –¥–ª—è –≤—ã–≤–æ–¥–∞ —Å—Ç—Ä–æ–∫–∏.
* –ù–∞–ø–∏—Å–∞—Ç—å –ø—Ä–æ—Å—Ç–æ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π —Ç–µ—Å—Ç, –≤—ã–∑—ã–≤–∞—é—â–∏–π `write`.
* –û—Ç–ª–∞–¥–∏—Ç—å –∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Ä–µ–∂–∏–º–æ–≤.

---

### –í—Ä–µ–º—è –Ω–∞ –∏–∑—É—á–µ–Ω–∏–µ –∏ –ø—Ä–∞–∫—Ç–∏–∫—É:

* –¢–µ–æ—Ä–∏—è: 3 —á–∞—Å–∞
* –ü—Ä–∞–∫—Ç–∏–∫–∞: 6 —á–∞—Å–æ–≤

---

### –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã:

* OSDev Wiki: System Calls ([https://wiki.osdev.org/System\_Call](https://wiki.osdev.org/System_Call))
* Intel SDM: –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ syscall/sysret
* –ö–Ω–∏–≥–∏ –ø–æ –û–° –∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –∏ —è–¥—Ä–æ–≤–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤

---

### –ú–µ—Ç–æ–¥–∏–∫–∞ –ø—Ä–µ–ø–æ–¥–∞–≤–∞–Ω–∏—è:

* –ü–æ—è—Å–Ω–µ–Ω–∏–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏ –∏ –∑–∞—â–∏—Ç—ã —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤
* –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –ø–µ—Ä–µ—Ö–æ–¥–∞ –º–µ–∂–¥—É —Ä–µ–∂–∏–º–∞–º–∏
* –°–æ–≤–º–µ—Å—Ç–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞
* –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è –æ—Ç–ª–∞–¥–∫–∞ –Ω–∞ —ç–º—É–ª—è—Ç–æ—Ä–µ

---

–ì–æ—Ç–æ–≤ –∫ —É—Ä–æ–∫—É 11 ‚Äî –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏—è –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∞–ø–ø–∞—Ä–∞—Ç–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π? ‚ö°Ô∏è
