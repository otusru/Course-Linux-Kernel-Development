–ö—Ä—É—Ç–æ, —Ç—ã —Å–ø—Ä–∞–≤–∏–ª—Å—è —Å —Ç–∞–±–ª–∏—Ü–∞–º–∏ —Å—Ç—Ä–∞–Ω–∏—Ü! –¢–µ–ø–µ—Ä—å –¥–∞–≤–∞–π –Ω–∞—É—á–∏–º —Ç–≤–æ—é –û–° —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –≤—ã–¥–µ–ª—è—Ç—å –ø–∞–º—è—Ç—å ‚Äî —Å –ø–æ–º–æ—â—å—é –∞–ª–ª–æ–∫–∞—Ç–æ—Ä–æ–≤! üßÆüß±

---

### üîπ –£—Ä–æ–∫ 82. –ê–ª–ª–æ–∫–∞—Ç–æ—Ä—ã –ø–∞–º—è—Ç–∏: buddy system –∏ heap –¥–ª—è —è–¥—Ä–∞

---

**–û–ø–∏—Å–∞–Ω–∏–µ:**
–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –ø–∞–º—è—Ç–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —É–º–µ—Ç—å —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –≤—ã–¥–µ–ª—è—Ç—å –∏ –æ—Å–≤–æ–±–æ–∂–¥–∞—Ç—å –ø–∞–º—è—Ç—å. –í —ç—Ç–æ–º —É—Ä–æ–∫–µ –º—ã —Ä–µ–∞–ª–∏–∑—É–µ–º –¥–≤–∞ —Ç–∏–ø–∞ –∞–ª–ª–æ–∫–∞—Ç–æ—Ä–æ–≤: **buddy system** ‚Äî –¥–ª—è –±–æ–ª—å—à–∏—Ö –±–ª–æ–∫–æ–≤ –ø–∞–º—è—Ç–∏, –∏ **heap-–∞–ª–ª–æ–∫–∞—Ç–æ—Ä** ‚Äî –¥–ª—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –º–µ–Ω—å—à–∏–º–∏ –±–ª–æ–∫–∞–º–∏ –≤ —è–¥—Ä–µ.

–û—Å–Ω–æ–≤–Ω—ã–µ —Ç–µ–º—ã:

* –¢–∏–ø—ã –∞–ª–ª–æ–∫–∞—Ç–æ—Ä–æ–≤: —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ä–∞–∑–º–µ—Ä, buddy, slab, heap
* –ê–ª–ª–æ–∫–∞—Ç–æ—Ä —è–¥—Ä–∞ vs –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π malloc
* –ü—Ä–æ–±–ª–µ–º–∞ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
* –°—Ç—Ä—É–∫—Ç—É—Ä–∞ buddy-–∞–ª–ª–æ–∫–∞—Ç–æ—Ä–∞ (–¥–≤–æ–π–∫–∏: 4–ö, 8–ö, 16–ö...)
* –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π heap-–∞–ª–ª–æ–∫–∞—Ç–æ—Ä: —Å–ø–∏—Å–æ–∫ —Å–≤–æ–±–æ–¥–Ω—ã—Ö –±–ª–æ–∫–æ–≤, coalescing
* –í—ã–¥–µ–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏ —Å –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ–º
* –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ –æ—à–∏–±–æ–∫

---

### –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ–µ –∑–∞–¥–∞–Ω–∏–µ:

* –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å buddy system —Å —É—Ä–æ–≤–Ω—è–º–∏ –æ—Ç 4 –ö–ë –¥–æ 2 –ú–ë
* –ù–∞–ø–∏—Å–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏ `kmalloc(size_t size)` –∏ `kfree(void*)`
* –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É heap —Å coalescing –∏ –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ–º
* –ù–∞–ø–∏—Å–∞—Ç—å —Ç–µ—Å—Ç—ã: –≤—ã–¥–µ–ª–µ–Ω–∏–µ, –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ, –ø—Ä–æ–≤–µ—Ä–∫–∞ –≥—Ä–∞–Ω–∏—Ü
* –î–æ–±–∞–≤–∏—Ç—å –≤ —è–¥—Ä–æ –ª–æ–≥ –ø–∞–º—è—Ç–∏: —Ç–µ–∫—É—â–∏–π —Ä–∞—Å—Ö–æ–¥, —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞—Ü–∏—è –∏ –æ—à–∏–±–∫–∏

---

### –í—Ä–µ–º—è –Ω–∞ –∏–∑—É—á–µ–Ω–∏–µ –∏ –ø—Ä–∞–∫—Ç–∏–∫—É:

* –¢–µ–æ—Ä–∏—è: 10 —á–∞—Å–æ–≤
* –ü—Ä–∞–∫—Ç–∏–∫–∞: 30 —á–∞—Å–æ–≤

---

### –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã:

* OSDev Wiki: [Heap](https://wiki.osdev.org/Heap), [Buddy Memory Allocation](https://wiki.osdev.org/Buddy_Memory_Allocation)
* –ö–Ω–∏–≥–∞: "Operating Systems: Three Easy Pieces" ‚Äî –≥–ª–∞–≤—ã –ø–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—é –ø–∞–º—è—Ç—å—é
* –†–µ–∞–ª–∏–∑–∞—Ü–∏—è malloc –≤ Linux, Minix, BSD (–¥–ª—è –≤–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏—è)
* –í–∏–¥–µ–æ—Ä–∞–∑–±–æ—Ä—ã buddy system –Ω–∞ YouTube

---

### –ú–µ—Ç–æ–¥–∏–∫–∞ –ø—Ä–µ–ø–æ–¥–∞–≤–∞–Ω–∏—è:

* –í–∏–∑—É–∞–ª—å–Ω–∞—è –ª–µ–∫—Ü–∏—è: —Ä–∏—Å—É–µ–º –¥–µ—Ä–µ–≤–æ buddy system –∏ —Å–ø–∏—Å–æ–∫ heap-–±–ª–æ–∫–æ–≤
* –ñ–∏–≤–æ–π –∫–æ–¥–∏–Ω–≥ ‚Äî –ø–∏—à–µ–º `kmalloc` –≤ —Ä–µ–∂–∏–º–µ live
* –ü—Ä–∞–∫—Ç–∏–∫–∞: —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤ –∏ —Å–∏–º—É–ª—è—Ü–∏—è –Ω–∞–≥—Ä—É–∑–∫–∏
* –°–æ–≤–µ—Ç—ã –ø–æ –æ—Ç–ª–∞–¥–∫–µ –æ—à–∏–±–æ–∫ –ø–∞–º—è—Ç–∏ –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–µ

---

üß± –ü–æ–∑–¥—Ä–∞–≤–ª—è—é! –¢–µ–ø–µ—Ä—å —Ç—ã —É–º–µ–µ—à—å —Å–æ–∑–¥–∞–≤–∞—Ç—å —Å–≤–æ–π —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π `malloc` ‚Äî —Ç–æ–ª—å–∫–æ –¥–ª—è —è–¥—Ä–∞! –ì–æ—Ç–æ–≤ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —É—Ä–æ–∫—É ‚Äî **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–π –ø–∞–º—è—Ç—å—é: —Å—Ç—Ä–∞–Ω–∏—Ü—ã, –∑–∞—â–∏—Ç–∞ –∏ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ**?
