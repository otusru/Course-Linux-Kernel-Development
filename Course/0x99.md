–û—Ç–ª–∏—á–Ω–æ! üöÄ –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ –æ–¥–Ω–æ–π –∏–∑ –∫–ª—é—á–µ–≤—ã—Ö —Ç–µ–º ‚Äî –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏—è 2.0! ‚ö°üîß

---

### üîπ –£—Ä–æ–∫ 99. –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏–π: –æ—Ç –∞–ø–ø–∞—Ä–∞—Ç—É—Ä—ã –¥–æ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–≥–æ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è

---

**–û–ø–∏—Å–∞–Ω–∏–µ:**
–ü—Ä–µ—Ä—ã–≤–∞–Ω–∏—è –ø–æ–∑–≤–æ–ª—è—é—Ç –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ –±—ã—Å—Ç—Ä–æ —Ä–µ–∞–≥–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ —Å–æ–±—ã—Ç–∏—è –æ—Ç –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è ‚Äî –æ—Ç –Ω–∞–∂–∞—Ç–∏—è –∫–ª–∞–≤–∏—à–∏ –¥–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –ø–µ—Ä–µ–¥–∞—á–∏ –ø–æ —Å–µ—Ç–∏. –í —ç—Ç–æ–º —É—Ä–æ–∫–µ –º—ã —É–≥–ª—É–±–∏–º—Å—è –≤ –º–µ—Ö–∞–Ω–∏–∑–º –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∞–ø–ø–∞—Ä–∞—Ç–Ω—ã—Ö –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏–π: –æ—Ç –∏—Ö –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ–º –¥–æ –ø–µ—Ä–µ–¥–∞—á–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–º—É –æ–±—Ä–∞–±–æ—Ç—á–∏–∫—É –≤ —è–¥—Ä–µ –û–°.

–û—Å–Ω–æ–≤–Ω—ã–µ —Ç–µ–º—ã:

* –í–∏–¥—ã –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏–π: –∞–ø–ø–∞—Ä–∞—Ç–Ω—ã–µ (IRQ), –ø—Ä–æ–≥—Ä–∞–º–º–Ω—ã–µ, –∏—Å–∫–ª—é—á–µ–Ω–∏—è
* –û–±—Ä–∞–±–æ—Ç–∫–∞ IRQ: PIC vs APIC vs x2APIC
* –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏–π –ø–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—É –∏ –º–∞—Å–∫–∏—Ä–æ–≤–∞–Ω–∏—é
* –ú–∞–ø–ø–∏–Ω–≥ IRQ –Ω–∞ IDT (Interrupt Descriptor Table)
* –ö–æ–Ω—Ç–µ–∫—Å—Ç –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏—è: —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ/–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–π
* –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏–π –ø–æ CPU (SMP)
* Lazy/Deferred –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏ bottom-half –º–µ—Ö–∞–Ω–∏–∑–º
* –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏–π –≤ –¥—Ä–∞–π–≤–µ—Ä–∞—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤
* –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–ª–æ–∂–µ–Ω–Ω—ã—Ö –∏ –ø–æ–≤—Ç–æ—Ä—è—é—â–∏—Ö—Å—è –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏–π
* –û—Ç–ª–∞–¥–∫–∞ –∏ —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∞ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏–π

---

### –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ–µ –∑–∞–¥–∞–Ω–∏–µ:

* –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é APIC –∏ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ IRQ
* –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ IRQ —Å –¥–∏—Å–ø–µ—Ç—á–µ—Ä–∏–∑–∞—Ü–∏–µ–π
* –ü–æ–¥–∫–ª—é—á–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏–π —Ç–∞–π–º–µ—Ä–∞, –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã, —Å–µ—Ç–µ–≤–æ–π –∫–∞—Ä—Ç—ã
* –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –±–∞–∑–æ–≤—ã–π –º–µ—Ö–∞–Ω–∏–∑–º deferred work (bottom-half)
* –ü—Ä–æ–≤–µ—Å—Ç–∏ –Ω–∞–≥—Ä—É–∑–æ—á–Ω—ã–µ —Ç–µ—Å—Ç—ã –∏ –æ—Ç–ª–∞–¥–∫—É —Å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º
* –ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –ø–æ–¥—Ä–æ–±–Ω—ã–π –æ—Ç—á—ë—Ç

---

### –í—Ä–µ–º—è –Ω–∞ –∏–∑—É—á–µ–Ω–∏–µ –∏ –ø—Ä–∞–∫—Ç–∏–∫—É:

* –¢–µ–æ—Ä–∏—è: 10 —á–∞—Å–æ–≤
* –ü—Ä–∞–∫—Ç–∏–∫–∞: 40 —á–∞—Å–æ–≤

---

### –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã:

* Intel SDM: —Ä–∞–∑–¥–µ–ª—ã –ø–æ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏—è–º –∏ APIC
* OSDev Wiki: [Advanced Programmable Interrupt Controller (APIC)](https://wiki.osdev.org/APIC)
* Linux source code: `arch/x86/kernel/apic`
* QEMU + GDB –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ –Ω–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã—Ö –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏–π

---

### –ú–µ—Ç–æ–¥–∏–∫–∞ –ø—Ä–µ–ø–æ–¥–∞–≤–∞–Ω–∏—è:

* –ì–ª—É–±–æ–∫–∞—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏—è
* –ü–æ—à–∞–≥–æ–≤–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ IDT + IRQ + APIC
* –ü—Ä–∞–∫—Ç–∏–∫–∞ –æ—Ç–ª–∞–¥–∫–∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Å–∏–º—É–ª—è—Ç–æ—Ä–æ–≤ –∏ –ª–æ–≥–æ–≤
* –°–æ–≤–µ—Ç—ã –ø–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∏ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—é ¬´—Å–ø–∞–º–∞¬ª –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏–π

---

‚ö° –ö—Ä–∞—Å–∞–≤—á–∏–∫! –¢–≤–æ—è –û–° —Ç–µ–ø–µ—Ä—å —É–º–µ–µ—Ç —Å–ø—Ä–∞–≤–ª—è—Ç—å—Å—è —Å –º–Ω–æ–∂–µ—Å—Ç–≤–æ–º —Å–æ–±—ã—Ç–∏–π –æ—Ç —É—Å—Ç—Ä–æ–π—Å—Ç–≤, –∏ —Ç—ã —Å–∞–º —Å—Ç–∞–ª –º–∞—Å—Ç–µ—Ä–æ–º –ø–æ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏—è–º. –ì–æ—Ç–æ–≤ –∫ —É—Ä–æ–∫—É 100 ‚Äî —é–±–∏–ª–µ–π–Ω—ã–π! –û–Ω –ø–æ—Å–≤—è—â—ë–Ω **—Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ —Ä–µ–∂–∏–º–∞ –∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—é –º–µ–∂–¥—É ring 0 –∏ ring 3** üßë‚Äçüíªüõ°Ô∏è?
