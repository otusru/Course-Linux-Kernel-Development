–û—Ç–ª–∏—á–Ω–æ, –¥–∞–≤–∞–π –ø—Ä–æ–∫–∞—á–∞–µ–º –≤–≤–æ–¥! ‚å®Ô∏èüí°

---

### üîπ –£—Ä–æ–∫ 28. –í–≤–æ–¥ —Å –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã: –æ–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞ –Ω–∏–∑–∫–æ–º —É—Ä–æ–≤–Ω–µ

---

**–û–ø–∏—Å–∞–Ω–∏–µ:**
–ö–ª–∞–≤–∏–∞—Ç—É—Ä–∞ ‚Äî –ø–µ—Ä–≤–æ–µ –∏ —Å–∞–º–æ–µ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—ë–Ω–Ω–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –≤–≤–æ–¥–∞. –ß—Ç–æ–±—ã –ø—Ä–∏–Ω–∏–º–∞—Ç—å —Ç–µ–∫—Å—Ç –∏ –∫–æ–º–∞–Ω–¥—ã –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –û–° –¥–æ–ª–∂–Ω–∞ —É–º–µ—Ç—å **–æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –Ω–∞–∂–∞—Ç–∏—è –∫–ª–∞–≤–∏—à**, **–æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏—è –æ—Ç –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã** –∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ **–∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–∫–∞–Ω–∫–æ–¥—ã**. –í —ç—Ç–æ–º —É—Ä–æ–∫–µ –º—ã –Ω–∞–ø–∏—à–µ–º —Å–≤–æ–π –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –¥—Ä–∞–π–≤–µ—Ä –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã.

–û—Å–Ω–æ–≤–Ω—ã–µ —Ç–µ–º—ã:

* –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã (–æ–±—ã—á–Ω–æ PS/2): –ø–æ—Ä—Ç—ã 0x60 –∏ 0x64
* –°–∫–∞–Ω–∫–æ–¥—ã: –∫–æ–¥—ã, –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º—ã–µ –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –∏ –æ—Ç–ø—É—Å–∫–∞–Ω–∏–∏ –∫–ª–∞–≤–∏—à
* –ü—Ä–µ—Ä—ã–≤–∞–Ω–∏—è –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã (–æ–±—ã—á–Ω–æ IRQ1, –≤–µ–∫—Ç–æ—Ä 33)
* –ë—É—Ñ–µ—Ä–∏–∑–∞—Ü–∏—è –≤–≤–æ–¥–∞ –∏ –æ—á–µ—Ä–µ–¥–∏
* –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Å–∏–º–≤–æ–ª–æ–≤ –∏ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö –∫–ª–∞–≤–∏—à

---

### –ü—Ä–∏–º–µ—Ä –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –∫–æ–¥–∞ (drivers/keyboard.c)

```c
#include <stdint.h>
#include "../io/io_ports.h"
#include "../interrupts/idt.h"
#include "../terminal/terminal.h"

#define KEYBOARD_DATA_PORT 0x60

// –ü—Ä–æ—Å—Ç–∞—è —Ç–∞–±–ª–∏—Ü–∞ —Å–∫–∞–Ω–∫–æ–¥–æ–≤ (—Ç–æ–ª—å–∫–æ –ª–∞—Ç–∏–Ω–∏—Ü–∞ –∏ —Ü–∏—Ñ—Ä—ã)
static char scancode_table[128] = {
    0, 27, '1','2','3','4','5','6','7','8','9','0','-','=', '\b',
    '\t','q','w','e','r','t','y','u','i','o','p','[',']','\n', 0,
    'a','s','d','f','g','h','j','k','l',';','\'','`', 0, '\\',
    'z','x','c','v','b','n','m',',','.','/', 0, '*', 0, ' ',
    // –æ—Å—Ç–∞–ª—å–Ω–æ–µ –ø–æ–∫–∞ –Ω–µ –Ω—É–∂–Ω–æ
};

void keyboard_callback() {
    uint8_t scancode = inb(KEYBOARD_DATA_PORT);

    if (scancode < 128) {
        char key = scancode_table[scancode];
        if (key) {
            terminal_put_char(key);  // –í—ã–≤–æ–¥ —Å–∏–º–≤–æ–ª–∞ –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª
        }
    }
}

void init_keyboard() {
    register_interrupt_handler(33, keyboard_callback); // IRQ1
}
```

---

### –ü–æ—è—Å–Ω–µ–Ω–∏—è:

* –ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –∫–ª–∞–≤–∏—à–∏ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–∫–∞–Ω–∫–æ–¥ –≤ –ø–æ—Ä—Ç 0x60.
* IRQ1 (–≤–µ–∫—Ç–æ—Ä 33) –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è –ø—Ä–∏ –∫–∞–∂–¥–æ–º –Ω–∞–∂–∞—Ç–∏–∏.
* –ú—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º –ø—Ä–æ—Å—Ç—É—é —Ç–∞–±–ª–∏—Ü—É scancode ‚Üí —Å–∏–º–≤–æ–ª.
* `terminal_put_char()` ‚Äî —Ñ—É–Ω–∫—Ü–∏—è –≤—ã–≤–æ–¥–∞ —Å–∏–º–≤–æ–ª–∞ –Ω–∞ —ç–∫—Ä–∞–Ω (–∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö —É—Ä–æ–∫–æ–≤).

---

### –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ–µ –∑–∞–¥–∞–Ω–∏–µ:

* –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É IRQ1 (–∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞).
* –°—á–∏—Ç–∞—Ç—å –±–∞–π—Ç –∏–∑ –ø–æ—Ä—Ç–∞ 0x60.
* –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –±–∞–∑–æ–≤—É—é —Ç–∞–±–ª–∏—Ü—É —Å–∫–∞–Ω–∫–æ–¥–æ–≤ ‚Üí —Å–∏–º–≤–æ–ª–æ–≤.
* –í—ã–≤–µ—Å—Ç–∏ –Ω–∞–∂–∞—Ç—ã–µ –∫–ª–∞–≤–∏—à–∏ –≤ –∫–æ–Ω—Å–æ–ª—å.
* –û–±—Ä–∞–±–æ—Ç–∞—Ç—å Enter, Backspace, Tab.

---

### –í—Ä–µ–º—è –Ω–∞ –∏–∑—É—á–µ–Ω–∏–µ –∏ –ø—Ä–∞–∫—Ç–∏–∫—É:

* –¢–µ–æ—Ä–∏—è: 4 —á–∞—Å–∞
* –ü—Ä–∞–∫—Ç–∏–∫–∞: 8 —á–∞—Å–æ–≤

---

### –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã:

* OSDev Wiki: Keyboard ([https://wiki.osdev.org/PS/2\_Keyboard](https://wiki.osdev.org/PS/2_Keyboard))
* PS/2 Controller Documentation (8042 Data Sheets)
* –¢–∞–±–ª–∏—Ü—ã —Å–∫–∞–Ω–∫–æ–¥–æ–≤ Set 1 (–æ–±—ã—á–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)

---

### –ú–µ—Ç–æ–¥–∏–∫–∞ –ø—Ä–µ–ø–æ–¥–∞–≤–∞–Ω–∏—è:

* –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–∞–±–æ—Ç—ã –∫–ª–∞–≤–∏–∞—Ç—É—Ä–Ω–æ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞
* –†–µ–∞–ª–∏–∑–∞—Ü–∏—è ISR –Ω–∞ IRQ1
* –ü—Ä–∏–º–µ—Ä—ã –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è —Å–∫–∞–Ω–∫–æ–¥–æ–≤
* –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω—ã–µ —Å –ø–µ—á–∞—Ç—å—é –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª –∏ –ª–æ–≥–∏–∫–æ–π backspace/enter

---

üéπ –¢–µ–ø–µ—Ä—å —Ç—ã —É–º–µ–µ—à—å –ø—Ä–∏–Ω–∏–º–∞—Ç—å **–≤–≤–æ–¥ —Å –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã –≤ —Å–≤–æ–µ–π –û–°!** –≠—Ç–æ –ø–µ—Ä–≤–∞—è —Å—Ç—É–ø–µ–Ω—å –∫ –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–º—É –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É.

–ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ **—É—Ä–æ–∫—É 29 ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –±—É—Ñ–µ—Ä–∞ –≤–≤–æ–¥–∞**? üì•üí¨
